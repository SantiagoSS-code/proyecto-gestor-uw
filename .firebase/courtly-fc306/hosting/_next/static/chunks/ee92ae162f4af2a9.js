(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,59824,e=>{"use strict";var a=e.i(88636),l=e.i(24892),t=e.i(77020),s=e.i(46266),r=e.i(60813),i=e.i(28289),n=e.i(48809),c=e.i(49056),o=e.i(47163);let d=[{href:"/dashboard-centros",label:"Panel",icon:i.LayoutDashboard},{href:"/dashboard-centros/courts",label:"Canchas",icon:n.Grid2X2},{href:"/dashboard-centros/settings",label:"Configuración",icon:c.Settings}];function u({title:e,description:l,children:i}){let n=(0,t.usePathname)();return(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[240px_1fr] gap-6",children:[(0,a.jsxs)("aside",{className:"bg-white border border-slate-200/70 shadow-sm rounded-2xl p-4 h-fit",children:[(0,a.jsxs)(s.default,{href:"/",className:"flex items-center gap-2 mb-6",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-600 flex items-center justify-center",children:(0,a.jsx)(r.Sparkles,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("span",{className:"font-semibold text-lg tracking-tight text-slate-900",children:"courtly"})]}),(0,a.jsx)("nav",{className:"space-y-1",children:d.map(e=>{let l=n===e.href,t=e.icon;return(0,a.jsxs)(s.default,{href:e.href,className:(0,o.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors",l?"bg-blue-600 text-white":"text-slate-700 hover:bg-slate-100"),children:[(0,a.jsx)(t,{className:"w-4 h-4"}),e.label]},e.href)})})]}),(0,a.jsxs)("section",{className:"bg-white border border-slate-200/70 shadow-sm rounded-2xl p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:e}),l?(0,a.jsx)("p",{className:"text-black mt-2",children:l}):null]}),i]})]})})})}var p=e.i(67881),m=e.i(91432),h=e.i(11663);e.i(99565);var x=e.i(50818),b=e.i(70065),g=e.i(23750),y=e.i(10708),j=e.i(62870),v=e.i(81947),f=e.i(90768),C=e.i(88297),N=e.i(87524),S=e.i(10965);let k=(0,S.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var w=e.i(20380);let L=(0,S.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var E=e.i(11741);let I=(0,S.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),T=["padel","tennis","futbol","pickleball","squash"],O=[{value:1,label:"Lun"},{value:2,label:"Mar"},{value:3,label:"Mié"},{value:4,label:"Jue"},{value:5,label:"Vie"},{value:6,label:"Sáb"},{value:0,label:"Dom"}],R={name:"",sport:"padel",coachName:"",durationMinutes:60,price:0,currency:"ARS",capacity:8,recurringSchedule:[],enabled:!0};function B(){let{user:e,loading:t}=(0,m.useAuth)(),[s,r]=(0,l.useState)([]),[i,n]=(0,l.useState)(!0),[c,o]=(0,l.useState)(!1),[d,u]=(0,l.useState)(null),[S,k]=(0,l.useState)({...R}),[B,A]=(0,l.useState)(null),_=(0,l.useMemo)(()=>S.name.trim().length>0,[S.name]);(0,l.useEffect)(()=>{let a=async()=>{if(e)try{let a=(0,x.collection)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.classes),l=(await (0,x.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()}));r(l)}catch(e){console.error("Error loading classes:",e),A({type:"error",text:"No se pudieron cargar las clases."})}finally{n(!1)}};!t&&e&&a()},[t,e]);let D=()=>{u(null),k({...R})},M=async()=>{if(e&&_){o(!0),A(null);try{let a={name:S.name.trim(),sport:S.sport,coachName:S.coachName?.trim()||"",durationMinutes:Number(S.durationMinutes)||60,price:Number(S.price)||0,currency:S.currency||"ARS",capacity:Number(S.capacity)||0,recurringSchedule:S.recurringSchedule||[],enabled:!!S.enabled,updatedAt:(0,x.serverTimestamp)()};if(d){let l=(0,x.doc)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.classes,d);await (0,x.updateDoc)(l,a),r(e=>e.map(e=>e.id===d?{...e,...a}:e)),A({type:"success",text:"Clase actualizada."})}else{let l=(0,x.collection)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.classes),t=await (0,x.addDoc)(l,{...a,createdAt:(0,x.serverTimestamp)()});r(e=>[...e,{id:t.id,...a}]),A({type:"success",text:"Clase creada."})}D()}catch(e){console.error("Error saving class:",e),A({type:"error",text:"No se pudo guardar la clase."})}finally{o(!1)}}},P=async a=>{if(e&&window.confirm("¿Eliminar esta clase?"))try{await (0,x.deleteDoc)((0,x.doc)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.classes,a)),r(e=>e.filter(e=>e.id!==a))}catch(e){console.error("Error deleting class:",e),A({type:"error",text:"No se pudo eliminar la clase."})}},U=(e,a)=>{k(l=>{let t=[...l.recurringSchedule||[]];return t[e]={...t[e],...a},{...l,recurringSchedule:t}})};return(0,a.jsxs)("div",{className:"space-y-6",children:[B&&(0,a.jsx)(v.Alert,{className:`mb-2 ${"success"===B.type?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,a.jsxs)(v.AlertDescription,{className:"success"===B.type?"text-green-800":"text-red-800",children:["success"===B.type?(0,a.jsx)(C.CheckCircle,{className:"w-4 h-4 inline mr-2"}):(0,a.jsx)(N.AlertCircle,{className:"w-4 h-4 inline mr-2"}),B.text]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1.2fr_0.8fr] gap-6",children:[(0,a.jsxs)(b.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,a.jsxs)(b.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)(b.CardTitle,{className:"text-lg text-slate-900",children:"Clases"}),(0,a.jsxs)(p.Button,{variant:"outline",size:"sm",onClick:D,className:"text-black",children:[(0,a.jsx)(L,{className:"w-4 h-4 mr-2"}),"Nueva clase"]})]}),(0,a.jsx)(b.CardContent,{className:"space-y-3",children:i?(0,a.jsxs)("div",{className:"flex items-center justify-center py-10 text-black",children:[(0,a.jsx)(f.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Cargando clases…"]}):0===s.length?(0,a.jsx)("div",{className:"text-center text-black py-10",children:"Aún no hay clases."}):s.map(e=>(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 rounded-xl border border-slate-200 p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-black",children:[(e.sport||"padel").toUpperCase()," · ",e.durationMinutes," min · ",e.currency||"ARS"," ",e.price]}),(0,a.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:!1!==e.enabled?"Activa":"Pausada"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(p.Button,{variant:"outline",size:"sm",onClick:()=>{u(e.id),k({name:e.name,sport:e.sport,coachName:e.coachName||"",durationMinutes:e.durationMinutes||60,price:e.price||0,currency:e.currency||"ARS",capacity:e.capacity||0,recurringSchedule:e.recurringSchedule||[],enabled:!1!==e.enabled})},children:(0,a.jsx)(I,{className:"w-4 h-4"})}),(0,a.jsx)(p.Button,{variant:"destructive",size:"sm",onClick:()=>P(e.id),children:(0,a.jsx)(E.Trash2,{className:"w-4 h-4"})})]})]},e.id))})]}),(0,a.jsxs)(b.Card,{className:"border border-slate-200/70 shadow-sm h-fit",children:[(0,a.jsx)(b.CardHeader,{children:(0,a.jsx)(b.CardTitle,{className:"text-lg text-slate-900",children:d?"Editar clase":"Crear clase"})}),(0,a.jsxs)(b.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Nombre"}),(0,a.jsx)(g.Input,{value:S.name,onChange:e=>k({...S,name:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Deporte"}),(0,a.jsxs)(j.Select,{value:S.sport,onValueChange:e=>k({...S,sport:e}),children:[(0,a.jsx)(j.SelectTrigger,{children:(0,a.jsx)(j.SelectValue,{placeholder:"Deporte"})}),(0,a.jsx)(j.SelectContent,{children:T.map(e=>(0,a.jsx)(j.SelectItem,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Coach"}),(0,a.jsx)(g.Input,{value:S.coachName||"",onChange:e=>k({...S,coachName:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Duración (min)"}),(0,a.jsx)(g.Input,{type:"number",min:"30",value:S.durationMinutes,onChange:e=>k({...S,durationMinutes:Number(e.target.value)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Capacidad"}),(0,a.jsx)(g.Input,{type:"number",min:"1",value:S.capacity,onChange:e=>k({...S,capacity:Number(e.target.value)})})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Precio"}),(0,a.jsx)(g.Input,{type:"number",min:"0",value:S.price,onChange:e=>k({...S,price:Number(e.target.value)})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Moneda"}),(0,a.jsx)(g.Input,{value:S.currency||"ARS",onChange:e=>k({...S,currency:e.target.value})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Activa"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:!!S.enabled,onChange:e=>k({...S,enabled:e.target.checked}),className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm text-black",children:"Disponible para reservas"})]})]}),(0,a.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"Horarios recurrentes"}),(0,a.jsxs)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{k(e=>({...e,recurringSchedule:[...e.recurringSchedule||[],{dayOfWeek:1,startTime:"18:00",endTime:"19:00"}]}))},children:[(0,a.jsx)(L,{className:"w-4 h-4 mr-1"}),"Añadir"]})]}),(0,a.jsx)("div",{className:"mt-3 space-y-2",children:0===(S.recurringSchedule||[]).length?(0,a.jsx)("div",{className:"text-xs text-slate-600",children:"Sin horarios aún."}):S.recurringSchedule.map((e,l)=>(0,a.jsxs)("div",{className:"grid grid-cols-[1fr_1fr_1fr_auto] gap-2 items-center",children:[(0,a.jsxs)(j.Select,{value:String(e.dayOfWeek),onValueChange:e=>U(l,{dayOfWeek:Number(e)}),children:[(0,a.jsx)(j.SelectTrigger,{children:(0,a.jsx)(j.SelectValue,{})}),(0,a.jsx)(j.SelectContent,{children:O.map(e=>(0,a.jsx)(j.SelectItem,{value:String(e.value),children:e.label},e.value))})]}),(0,a.jsx)(g.Input,{type:"time",value:e.startTime,onChange:e=>U(l,{startTime:e.target.value})}),(0,a.jsx)(g.Input,{type:"time",value:e.endTime,onChange:e=>U(l,{endTime:e.target.value})}),(0,a.jsx)(p.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>{k(e=>({...e,recurringSchedule:(e.recurringSchedule||[]).filter((e,a)=>a!==l)}))},children:(0,a.jsx)(E.Trash2,{className:"w-4 h-4"})})]},l))})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[d?(0,a.jsx)(p.Button,{variant:"outline",onClick:D,children:"Cancelar"}):null,(0,a.jsx)(p.Button,{onClick:M,disabled:c||!_,className:"bg-blue-600 hover:bg-blue-700 text-white",children:c?(0,a.jsx)(f.Loader2,{className:"w-4 h-4 animate-spin"}):"Guardar"})]})]})]})]})]})}var A=e.i(9599);function _(e){return e.name}let D=(e,a,l=_)=>l(e)<l(a)?-1:+(l(e)>l(a));var M=e.i(15268),P=e.i(39940);let U=["name","countryCode","stateCode","latitude","longitude"],z=[],F=e=>{let a=e.trim().toLowerCase();return e=>!a||e.name.toLowerCase().includes(a)},H=(e,a)=>e.label.localeCompare(a.label),$=e=>{let a=new Set;return e.filter(e=>{let l=e.label.toLowerCase();return!a.has(l)&&(a.add(l),!0)})},V=(e,a)=>{let l=e.address||{};return[l.suburb,l.neighbourhood,l.hamlet,l.village,l.town,l.city,l.municipality,l.county,...a].find(Boolean)||e.display_name},G=async(e,a)=>{let l=`/api/geo/search?q=${encodeURIComponent(e)}&limit=${a}`,t=await fetch(l);return t.ok?await t.json():[]},q=async(e,a,l)=>{let t=new URLSearchParams;t.set("postalcode",e),t.set("limit",String(l)),a&&t.set("countrycodes",a);let s=await fetch(`/api/geo/search?${t.toString()}`);return s.ok?await s.json():[]};async function W({level:e,parentId:a=null,search:l="",maxResults:t=200,context:s}){if("country"===e)return A.default.filter(F(l)).map(e=>({id:`country-${e.isoCode}`,label:e.name,level:"country",parentId:null})).sort(H).slice(0,t);if("province"===e&&a){let e=a.replace("country-","");return(function(e=""){return e?M.default.filter(a=>a.countryCode===e).sort(D):[]})(e).filter(F(l)).map(l=>({id:`province-${e}-${l.isoCode}`,label:l.name,level:"province",parentId:a})).sort(H).slice(0,t)}if(("city"===e||"locality"===e||"postalCode"===e)&&a){var r,i;let n=a.split("-"),c=n[1],o=n[2],d=s?.countryLabel||"",u=s?.provinceLabel||"",p=s?.cityLabel||"",m=s?.countryId?.replace("country-","")||null;if("postalCode"===e){if(!l.trim())return[];let e=await q(l,m,Math.min(t,25));return $(e.map(e=>e.address?.postcode||e.display_name).filter(Boolean).map((l,t)=>{let s=e[t];return{id:`postal-${c}-${o}-${String(l).replace(/\s+/g,"")}`,label:String(l),level:"postalCode",parentId:a,lat:s?.lat?Number(s.lat):null,lng:s?.lon?Number(s.lon):null}})).slice(0,t)}if("locality"===e){if(!l.trim())return[];let e=[l,p,u,d].filter(Boolean).join(", ");return $((await G(e,Math.min(t,25))).map(e=>({id:`locality-${e.place_id}`,label:V(e,[e.display_name]),level:"locality",parentId:a,lat:e.lat?Number(e.lat):null,lng:e.lon?Number(e.lon):null}))).slice(0,t)}if(l.trim()){let e=[l,u,d].filter(Boolean).join(", ");return $((await G(e,Math.min(t,25))).map(e=>({id:`city-${e.place_id}`,label:V(e,[e.display_name]),level:"city",parentId:a,lat:e.lat?Number(e.lat):null,lng:e.lon?Number(e.lon):null}))).slice(0,t)}return(r=c,(i=o)&&r?(function(e=U){var a;if(z.length)return z;let l=P.default;return a=null!=e?e:U,z=l.map(e=>Object.fromEntries(a.map((a,l)=>[a,e[l]])))})().filter(e=>e.countryCode===r&&e.stateCode===i).sort(D):[]).filter(F(l)).map(e=>({id:`city-${c}-${o}-${e.name}`,label:e.name,level:"city",parentId:a})).sort(H).slice(0,t)}return[]}let J=[{key:"bar",label:"Bar"},{key:"bathrooms",label:"Baños"},{key:"showers",label:"Duchas"},{key:"gym",label:"Gimnasio"},{key:"parking",label:"Estacionamiento"},{key:"lockers",label:"Vestuarios"},{key:"wifi",label:"Wi‑Fi"},{key:"shop",label:"Tienda"},{key:"cafeteria",label:"Cafetería"}],K=[{key:"padel",label:"Padel"},{key:"tennis",label:"Tennis"},{key:"futbol",label:"Fútbol"},{key:"pickleball",label:"Pickleball"},{key:"squash",label:"Squash"}],X={country:null,province:null,city:null,locality:null,postalCode:null};function Z({label:e,placeholder:l,value:t,options:s,loading:r,disabled:i,searchValue:n,onSearchChange:c,onSelect:o,emptyMessage:d}){let u=s.filter(e=>e.label.toLowerCase().includes(n.trim().toLowerCase()));return(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:e}),(0,a.jsxs)(j.Select,{value:t?.id||"",onValueChange:e=>{let a=s.find(a=>a.id===e);a&&o(a)},disabled:i,children:[(0,a.jsx)(j.SelectTrigger,{className:"w-full",children:(0,a.jsx)(j.SelectValue,{placeholder:l})}),(0,a.jsxs)(j.SelectContent,{children:[(0,a.jsx)("div",{className:"p-2",children:(0,a.jsx)(g.Input,{value:n,onChange:e=>c(e.target.value),placeholder:"Buscar…",className:"h-8",disabled:i})}),(0,a.jsx)(j.SelectSeparator,{}),r?(0,a.jsx)(j.SelectItem,{value:"__loading",disabled:!0,children:"Cargando…"}):u.length?u.map(e=>(0,a.jsx)(j.SelectItem,{value:e.id,children:e.label},e.id)):(0,a.jsx)(j.SelectItem,{value:"__empty",disabled:!0,children:d})]})]})]})}async function Q(e,a){let l=(0,o.slugify)(e);if(!l)return"";let t=async e=>{let l=(0,x.query)((0,x.collection)(h.db,w.FIRESTORE_COLLECTIONS.centers),(0,x.where)("slug","==",e));return(await (0,x.getDocs)(l)).docs.some(e=>e.id!==a)};if(!await t(l))return l;for(let e=2;e<=50;e++){let a=`${l}-${e}`;if(!await t(a))return a}return`${l}-${Date.now()}`}function Y(){let{user:e,loading:t}=(0,m.useAuth)(),[s,r]=(0,l.useState)(!0),[i,n]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[u,j]=(0,l.useState)({name:"",phone:"",address:"",street:"",streetNumber:"",province:"",postalCode:"",city:"",country:"",placeId:"",location:null,description:"",amenities:[],sports:["padel"],coverImageUrl:null,galleryImageUrls:[],slug:"",published:!1,classesEnabled:!1,featuredRank:null,topSearchedRank:null}),[S,L]=(0,l.useState)(""),[E,I]=(0,l.useState)(""),[T,O]=(0,l.useState)(!1),[R,A]=(0,l.useState)(X),[_,D]=(0,l.useState)({country:"",province:"",city:"",locality:"",postalCode:""}),[M,P]=(0,l.useState)([]),[U,z]=(0,l.useState)([]),[F,H]=(0,l.useState)([]),[$,V]=(0,l.useState)([]),[G,q]=(0,l.useState)([]),[Y,ee]=(0,l.useState)({country:!1,province:!1,city:!1,locality:!1,postalCode:!1});(0,l.useEffect)(()=>{let a=async()=>{if(e)try{let a=(0,x.doc)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid),l=await (0,x.getDoc)(a);if(l.exists()){let e=l.data();j(a=>({...a,...e,name:e.name||a.name,street:e.street||a.street,streetNumber:e.streetNumber||a.streetNumber,province:e.province||a.province,postalCode:e.postalCode||a.postalCode,amenities:e.amenities||[],sports:e.sports||[],galleryImageUrls:e.galleryImageUrls||[],coverImageUrl:e.coverImageUrl??null,published:!!e.published,slug:e.slug||"",placeId:e.placeId||"",location:e.location||null,classesEnabled:!!e.classesEnabled})),e.location?.lat&&L(String(e.location.lat)),e.location?.lng&&I(String(e.location.lng));let a=e.location||null,t=a?.country?.id?a.country:null,s=a?.province?.id?a.province:null,r=a?.city?.id?a.city:null,i=a?.locality?.id?a.locality:null,n=a?.postalCode?.id?a.postalCode:null;A({country:t,province:s,city:r,locality:i,postalCode:n})}else await (0,x.setDoc)(a,{name:"",published:!1,createdAt:(0,x.serverTimestamp)()},{merge:!0})}catch(e){console.error("Failed to load club profile:",e),d({type:"error",text:"No se pudo cargar el perfil del club."})}finally{r(!1)}};!t&&e&&a()},[t,e]);let ea=(0,l.useMemo)(()=>u.name.trim().length>0,[u.name]),el=(0,l.useMemo)(()=>[[u.street?.trim(),u.streetNumber?.trim()].filter(Boolean).join(" "),[R.locality?.label,R.city?.label,R.province?.label,R.postalCode?.label,R.country?.label].filter(Boolean).join(", ")].filter(Boolean).join(", "),[u.street,u.streetNumber,R]);(0,l.useEffect)(()=>{let e=!0;return(async()=>{ee(e=>({...e,country:!0}));try{let a=await W({level:"country",search:_.country});e&&P(a)}catch(e){console.error("Failed to load countries",e)}finally{e&&ee(e=>({...e,country:!1}))}})(),()=>{e=!1}},[_.country]),(0,l.useEffect)(()=>{if(!R.country?.id)return void z([]);let e=!0;return(async()=>{ee(e=>({...e,province:!0}));try{let a=await W({level:"province",parentId:R.country?.id,search:_.province});e&&z(a)}catch(e){console.error("Failed to load provinces",e)}finally{e&&ee(e=>({...e,province:!1}))}})(),()=>{e=!1}},[_.province,R.country?.id]),(0,l.useEffect)(()=>{if(!R.province?.id)return void H([]);let e=!0;return(async()=>{ee(e=>({...e,city:!0}));try{let a=await W({level:"city",parentId:R.province?.id,search:_.city,context:{countryLabel:R.country?.label,provinceLabel:R.province?.label,countryId:R.country?.id}});e&&H(a)}catch(e){console.error("Failed to load cities",e)}finally{e&&ee(e=>({...e,city:!1}))}})(),()=>{e=!1}},[_.city,R.province?.id]),(0,l.useEffect)(()=>{if(!R.city?.id)return void V([]);let e=!0;return(async()=>{ee(e=>({...e,locality:!0}));try{let a=await W({level:"locality",parentId:R.city?.id,search:_.locality,context:{countryLabel:R.country?.label,provinceLabel:R.province?.label,cityLabel:R.city?.label,countryId:R.country?.id}});e&&V(a)}catch(e){console.error("Failed to load localities",e)}finally{e&&ee(e=>({...e,locality:!1}))}})(),()=>{e=!1}},[_.locality,R.city?.id]),(0,l.useEffect)(()=>{if(!R.locality?.id)return void q([]);let e=!0;return(async()=>{ee(e=>({...e,postalCode:!0}));try{let a=await W({level:"postalCode",parentId:R.locality?.id,search:_.postalCode,context:{countryLabel:R.country?.label,provinceLabel:R.province?.label,cityLabel:R.city?.label,countryId:R.country?.id}});e&&q(a)}catch(e){console.error("Failed to load postal codes",e)}finally{e&&ee(e=>({...e,postalCode:!1}))}})(),()=>{e=!1}},[_.postalCode,R.locality?.id]);let et=async()=>{if(e){d(null);try{let a=await Q(u.name,e.uid);j(e=>({...e,slug:a}))}catch(e){console.error("Slug generation failed:",e),d({type:"error",text:"No se pudo generar un slug único."})}}},es=async()=>{if(e){O(!0);try{let a=(0,x.collection)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.courts),l=await (0,x.getDocs)(a),t=Array.from(new Set(l.docs.map(e=>e.data()?.sport).filter(Boolean)));j(e=>({...e,sports:t}))}catch(e){console.error("Failed to sync sports:",e),d({type:"error",text:"No se pudieron sincronizar los deportes."})}finally{O(!1)}}},er=async()=>{if(e&&ea){n(!0),d(null);try{let a=e.uid,l=u.coverImageUrl||null,t=[...u.galleryImageUrls||[]];if(!u.slug){let e=await Q(u.name,a);j(a=>({...a,slug:e}))}let s=""===S.trim()?NaN:Number(S),r=""===E.trim()?NaN:Number(E),i={country:R.country,province:R.province,city:R.city,locality:R.locality,postalCode:R.postalCode,fullAddress:el,lat:Number.isFinite(s)?s:null,lng:Number.isFinite(r)?r:null},n={name:u.name.trim(),phone:u.phone?.trim()||"",address:el||u.address?.trim()||"",street:u.street?.trim()||"",streetNumber:u.streetNumber?.trim()||"",province:R.province?.label||"",postalCode:R.postalCode?.label||"",city:R.city?.label||"",country:R.country?.label||"",placeId:u.placeId?.trim()||"",location:i,description:u.description?.trim()||"",amenities:u.amenities||[],sports:u.sports||[],coverImageUrl:l,galleryImageUrls:t,slug:u.slug?(0,o.slugify)(u.slug):(0,o.slugify)(u.name),published:!!u.published,classesEnabled:!!u.classesEnabled,featuredRank:u.featuredRank??null,topSearchedRank:u.topSearchedRank??null,updatedAt:(0,x.serverTimestamp)()},c=(0,x.doc)(h.db,w.FIRESTORE_COLLECTIONS.centers,a);await (0,x.updateDoc)(c,n),j(e=>({...e,coverImageUrl:l,galleryImageUrls:t,slug:n.slug})),d({type:"success",text:"Perfil del club guardado."})}catch(e){console.error("Save club profile failed:",e),d({type:"error",text:"No se pudo guardar el perfil del club."})}finally{n(!1)}}};return s?(0,a.jsxs)("div",{className:"flex items-center justify-center py-10 text-black",children:[(0,a.jsx)(f.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Cargando perfil del club…"]}):(0,a.jsxs)("div",{className:"space-y-6",children:[c&&(0,a.jsx)(v.Alert,{className:`mb-2 ${"success"===c.type?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,a.jsxs)(v.AlertDescription,{className:"success"===c.type?"text-green-800":"text-red-800",children:["success"===c.type?(0,a.jsx)(C.CheckCircle,{className:"w-4 h-4 inline mr-2"}):(0,a.jsx)(N.AlertCircle,{className:"w-4 h-4 inline mr-2"}),c.text]})}),(0,a.jsxs)(b.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,a.jsx)(b.CardHeader,{children:(0,a.jsx)(b.CardTitle,{className:"text-lg text-slate-900",children:"Perfil público del club"})}),(0,a.jsxs)(b.CardContent,{className:"space-y-5",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Nombre del club"}),(0,a.jsx)(g.Input,{value:u.name,onChange:e=>j({...u,name:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Teléfono"}),(0,a.jsx)(g.Input,{value:u.phone||"",onChange:e=>j({...u,phone:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Calle"}),(0,a.jsx)(g.Input,{value:u.street||"",onChange:e=>j({...u,street:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Número"}),(0,a.jsx)(g.Input,{value:u.streetNumber||"",onChange:e=>j({...u,streetNumber:e.target.value})})]}),(0,a.jsx)(Z,{label:"País",placeholder:"Seleccionar país",value:R.country,options:M,loading:Y.country,searchValue:_.country,onSearchChange:e=>D(a=>({...a,country:e})),onSelect:e=>{A({country:e,province:null,city:null,locality:null,postalCode:null}),D(e=>({...e,province:"",city:"",locality:"",postalCode:""})),z([]),H([]),V([]),q([])},emptyMessage:"No hay países disponibles."}),(0,a.jsx)(Z,{label:"Provincia / Estado",placeholder:R.country?"Seleccionar provincia":"Seleccioná un país",value:R.province,options:U,loading:Y.province,disabled:!R.country,searchValue:_.province,onSearchChange:e=>D(a=>({...a,province:e})),onSelect:e=>{A({country:R.country,province:e,city:null,locality:null,postalCode:null}),D(e=>({...e,city:"",locality:"",postalCode:""})),H([]),V([]),q([])},emptyMessage:R.country?"Sin provincias para este país.":"Seleccioná un país primero."}),(0,a.jsx)(Z,{label:"Ciudad",placeholder:R.province?"Seleccionar ciudad":"Seleccioná una provincia",value:R.city,options:F,loading:Y.city,disabled:!R.province,searchValue:_.city,onSearchChange:e=>D(a=>({...a,city:e})),onSelect:e=>{A({country:R.country,province:R.province,city:e,locality:null,postalCode:null}),"number"==typeof e.lat&&"number"==typeof e.lng&&(L(String(e.lat)),I(String(e.lng))),D(e=>({...e,locality:"",postalCode:""})),V([]),q([])},emptyMessage:R.province?_.city?"Sin resultados para esa búsqueda.":"Escribí para buscar una ciudad.":"Seleccioná una provincia primero."}),(0,a.jsx)(Z,{label:"Localidad",placeholder:R.city?"Seleccionar localidad":"Seleccioná una ciudad",value:R.locality,options:$,loading:Y.locality,disabled:!R.city,searchValue:_.locality,onSearchChange:e=>D(a=>({...a,locality:e})),onSelect:e=>{A({country:R.country,province:R.province,city:R.city,locality:e,postalCode:null}),"number"==typeof e.lat&&"number"==typeof e.lng&&(L(String(e.lat)),I(String(e.lng))),D(e=>({...e,postalCode:""})),q([])},emptyMessage:R.city?_.locality?"Sin resultados para esa búsqueda.":"Escribí para buscar una localidad.":"Seleccioná una ciudad primero."}),(0,a.jsx)(Z,{label:"Código postal",placeholder:R.locality?"Seleccionar código postal":"Seleccioná una localidad",value:R.postalCode,options:G,loading:Y.postalCode,disabled:!R.locality,searchValue:_.postalCode,onSearchChange:e=>D(a=>({...a,postalCode:e})),onSelect:e=>{A({country:R.country,province:R.province,city:R.city,locality:R.locality,postalCode:e}),"number"==typeof e.lat&&"number"==typeof e.lng&&(L(String(e.lat)),I(String(e.lng)))},emptyMessage:R.locality?_.postalCode?"Sin resultados para esa búsqueda.":"Escribí para buscar un código postal.":"Seleccioná una localidad primero."}),(0,a.jsxs)("div",{className:"md:col-span-2",children:[(0,a.jsx)(y.Label,{children:"Dirección completa (autogenerada)"}),(0,a.jsx)(g.Input,{value:el,readOnly:!0,className:"bg-slate-50"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Descripción"}),(0,a.jsx)("textarea",{value:u.description||"",onChange:e=>j({...u,description:e.target.value}),className:"w-full min-h-[120px] rounded-md border border-slate-200 px-3 py-2 text-sm"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Google Maps Place ID (opcional)"}),(0,a.jsx)(g.Input,{value:u.placeId||"",onChange:e=>j({...u,placeId:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Coordenadas (lat, lng)"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,a.jsx)(g.Input,{value:S,onChange:e=>L(e.target.value),placeholder:"-34.6037"}),(0,a.jsx)(g.Input,{value:E,onChange:e=>I(e.target.value),placeholder:"-58.3816"})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-slate-900 mb-2",children:"Servicios"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:J.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-black",children:[(0,a.jsx)("input",{type:"checkbox",checked:(u.amenities||[]).includes(e.key),onChange:()=>{var a;return a=e.key,void j(e=>{let l=new Set(e.amenities||[]);return l.has(a)?l.delete(a):l.add(a),{...e,amenities:Array.from(l)}})}}),e.label]},e.key))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-2",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"Deportes disponibles"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:es,disabled:T,children:T?(0,a.jsx)(f.Loader2,{className:"w-4 h-4 animate-spin"}):"Sincronizar desde canchas"})]}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-2",children:K.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-black",children:[(0,a.jsx)("input",{type:"checkbox",checked:(u.sports||[]).includes(e.key),onChange:()=>{var a;return a=e.key,void j(e=>{let l=new Set(e.sports||[]);return l.has(a)?l.delete(a):l.add(a),{...e,sports:Array.from(l)}})}}),e.label]},e.key))})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Imagen de portada"}),(0,a.jsx)(g.Input,{type:"text",placeholder:"https://ejemplo.com/imagen.jpg",value:u.coverImageUrl||"",onChange:e=>j({...u,coverImageUrl:e.target.value||null})}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Pega la URL de una imagen (Google Drive, redes sociales, etc.)"}),u.coverImageUrl?(0,a.jsx)("img",{src:u.coverImageUrl,alt:"",className:"mt-3 h-40 w-full object-cover rounded-xl border border-slate-200"}):null]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Imágenes de la galería (URLs separadas por coma)"}),(0,a.jsx)(g.Input,{type:"text",placeholder:"https://url1.jpg, https://url2.jpg",value:(u.galleryImageUrls||[]).join(", "),onChange:e=>{let a=e.target.value.split(",").map(e=>e.trim()).filter(Boolean);j({...u,galleryImageUrls:a})}}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Pega URLs separadas por coma"}),u.galleryImageUrls?.length?(0,a.jsx)("div",{className:"mt-3 grid grid-cols-3 gap-2",children:u.galleryImageUrls.slice(0,6).map(e=>(0,a.jsx)("img",{src:e,alt:"",className:"h-20 w-full object-cover rounded-lg border border-slate-200"},e))}):null]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Slug"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(g.Input,{value:u.slug||"",onChange:e=>j({...u,slug:e.target.value})}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",onClick:et,className:"text-black",children:(0,a.jsx)(k,{className:"w-4 h-4"})})]}),(0,a.jsxs)("div",{className:"text-xs text-black mt-1",children:["URL pública: /clubs/",u.slug||"…"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Publicar"}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-black",children:[(0,a.jsx)("input",{type:"checkbox",checked:!!u.published,onChange:e=>j({...u,published:e.target.checked})}),"Visible en /clubs"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Clases habilitadas"}),(0,a.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-black",children:[(0,a.jsx)("input",{type:"checkbox",checked:!!u.classesEnabled,onChange:e=>j({...u,classesEnabled:e.target.checked})}),"Mostrar clases en la página pública"]})]}),(0,a.jsx)("div",{className:"flex items-center justify-end gap-3",children:(0,a.jsx)(p.Button,{onClick:er,disabled:i||!ea,className:"bg-blue-600 hover:bg-blue-700 text-white",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Loader2,{className:"w-4 h-4 animate-spin mr-2"}),"Guardando…"]}):"Guardar perfil"})})]})]}),u.classesEnabled?(0,a.jsxs)(b.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,a.jsx)(b.CardHeader,{children:(0,a.jsx)(b.CardTitle,{className:"text-lg text-slate-900",children:"Clases y escuelas"})}),(0,a.jsx)(b.CardContent,{children:(0,a.jsx)(B,{})})]}):null]})}let ee=["Sintética","Césped","Arcilla","Dura","Otra"],ea=["padel","tennis","futbol","pickleball","squash"],el={name:"",sport:"padel",indoor:!1,surfaceType:"Synthetic",pricePerHour:"",currency:"ARS",published:!0};function et(){let{user:e,loading:t}=(0,m.useAuth)(),[s,r]=(0,l.useState)([]),[i,n]=(0,l.useState)(!0),[c,o]=(0,l.useState)(!1),[d,u]=(0,l.useState)(null),[S,k]=(0,l.useState)({...el}),[T,O]=(0,l.useState)(null),R=(0,l.useMemo)(()=>S.name.trim().length>0,[S.name]);(0,l.useEffect)(()=>{let a=async()=>{if(e)try{let a=(0,x.collection)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.courts),l=(await (0,x.getDocs)(a)).docs.map(e=>({id:e.id,...e.data()}));r(l)}catch(e){console.error("Error loading courts:",e),O({type:"error",text:"No se pudieron cargar las canchas. Intenta de nuevo."})}finally{n(!1)}};!t&&e&&a()},[t,e]);let B=()=>{u(null),k({...el})},A=async()=>{if(e&&R){o(!0),O(null);try{let a={name:S.name.trim(),sport:S.sport,indoor:S.indoor,surfaceType:S.surfaceType,pricePerHour:S.pricePerHour?Number(S.pricePerHour):null,currency:"ARS",published:!!S.published,updatedAt:(0,x.serverTimestamp)()};if(d){let l=(0,x.doc)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.courts,d);await (0,x.updateDoc)(l,a),r(e=>e.map(e=>e.id===d?{...e,...a}:e)),O({type:"success",text:"Cancha actualizada correctamente."})}else{let l=(0,x.collection)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.courts),t=await (0,x.addDoc)(l,{...a,createdAt:(0,x.serverTimestamp)()});r(e=>[...e,{id:t.id,...a}]),O({type:"success",text:"Cancha creada correctamente."})}B()}catch(e){console.error("Error saving court:",e),O({type:"error",text:"No se pudo guardar la cancha. Intenta de nuevo."})}finally{o(!1)}}},_=async a=>{if(e&&window.confirm("¿Eliminar esta cancha? Esta acción no se puede deshacer."))try{await (0,x.deleteDoc)((0,x.doc)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.courts,a)),r(e=>e.filter(e=>e.id!==a))}catch(e){console.error("Error deleting court:",e),O({type:"error",text:"No se pudo eliminar la cancha. Intenta de nuevo."})}};return(0,a.jsxs)("div",{className:"space-y-6",children:[T&&(0,a.jsx)(v.Alert,{className:`mb-2 ${"success"===T.type?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,a.jsxs)(v.AlertDescription,{className:"success"===T.type?"text-green-800":"text-red-800",children:["success"===T.type?(0,a.jsx)(C.CheckCircle,{className:"w-4 h-4 inline mr-2"}):(0,a.jsx)(N.AlertCircle,{className:"w-4 h-4 inline mr-2"}),T.text]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1.2fr_0.8fr] gap-6",children:[(0,a.jsxs)(b.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,a.jsxs)(b.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,a.jsx)(b.CardTitle,{className:"text-lg text-slate-900",children:"Tus canchas"}),(0,a.jsxs)(p.Button,{variant:"outline",size:"sm",onClick:B,className:"text-black",children:[(0,a.jsx)(L,{className:"w-4 h-4 mr-2"}),"Nueva cancha"]})]}),(0,a.jsx)(b.CardContent,{className:"space-y-3",children:i?(0,a.jsxs)("div",{className:"flex items-center justify-center py-10 text-black",children:[(0,a.jsx)(f.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Cargando canchas…"]}):0===s.length?(0,a.jsx)("div",{className:"text-center text-black py-10",children:"Aún no hay canchas. Crea tu primera cancha."}):s.map(e=>(0,a.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 rounded-xl border border-slate-200 p-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"font-semibold text-slate-900",children:e.name}),(0,a.jsxs)("p",{className:"text-sm text-black",children:[(e.sport||"padel").toUpperCase()," · ",e.indoor?"Interior":"Exterior"," · ",e.surfaceType||"—","number"==typeof e.pricePerHour?` \xb7 ${e.currency||"USD"} ${e.pricePerHour}/h`:""]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold ${!1!==e.published?"bg-blue-50 text-blue-700":"bg-slate-100 text-slate-700"}`,children:!1!==e.published?"Publicada":"Borrador"}),(0,a.jsx)(p.Button,{variant:"outline",size:"sm",onClick:()=>{u(e.id),k({name:e.name,sport:e.sport||"padel",indoor:!!e.indoor,surfaceType:e.surfaceType||"Synthetic",pricePerHour:"number"==typeof e.pricePerHour?e.pricePerHour.toString():"",currency:"ARS",published:!1!==e.published})},children:(0,a.jsx)(I,{className:"w-4 h-4"})}),(0,a.jsx)(p.Button,{variant:"destructive",size:"sm",onClick:()=>_(e.id),children:(0,a.jsx)(E.Trash2,{className:"w-4 h-4"})})]})]},e.id))})]}),(0,a.jsxs)(b.Card,{className:"border border-slate-200/70 shadow-sm h-fit",children:[(0,a.jsx)(b.CardHeader,{children:(0,a.jsx)(b.CardTitle,{className:"text-lg text-slate-900",children:d?"Editar cancha":"Crear cancha"})}),(0,a.jsxs)(b.CardContent,{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Nombre de la cancha"}),(0,a.jsx)(g.Input,{value:S.name,onChange:e=>k({...S,name:e.target.value})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Deporte"}),(0,a.jsxs)(j.Select,{value:S.sport,onValueChange:e=>k({...S,sport:e}),children:[(0,a.jsx)(j.SelectTrigger,{children:(0,a.jsx)(j.SelectValue,{placeholder:"Deporte"})}),(0,a.jsx)(j.SelectContent,{children:ea.map(e=>(0,a.jsx)(j.SelectItem,{value:e,children:e},e))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Superficie"}),(0,a.jsxs)(j.Select,{value:S.surfaceType,onValueChange:e=>k({...S,surfaceType:e}),children:[(0,a.jsx)(j.SelectTrigger,{children:(0,a.jsx)(j.SelectValue,{placeholder:"Tipo de superficie"})}),(0,a.jsx)(j.SelectContent,{children:ee.map(e=>(0,a.jsx)(j.SelectItem,{value:e,children:e},e))})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Interior"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:S.indoor,onChange:e=>k({...S,indoor:e.target.checked}),className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm text-black",children:"Esta cancha es interior"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Precio por hora"}),(0,a.jsx)(g.Input,{type:"number",min:"0",value:S.pricePerHour,onChange:e=>k({...S,pricePerHour:e.target.value})})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Moneda"}),(0,a.jsx)(g.Input,{value:"ARS",disabled:!0})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Publicada"}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:S.published,onChange:e=>k({...S,published:e.target.checked}),className:"h-4 w-4"}),(0,a.jsx)("span",{className:"text-sm text-black",children:"Mostrar esta cancha en páginas públicas"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[d?(0,a.jsx)(p.Button,{variant:"outline",onClick:B,children:"Cancelar"}):null,(0,a.jsx)(p.Button,{onClick:A,disabled:c||!R,className:"bg-blue-600 hover:bg-blue-700 text-white",children:c?(0,a.jsx)(f.Loader2,{className:"w-4 h-4 animate-spin"}):"Guardar"})]})]})]})]})]})}let es=[30,60,90,120],er=[{index:"1",label:"Lun"},{index:"2",label:"Mar"},{index:"3",label:"Mié"},{index:"4",label:"Jue"},{index:"5",label:"Vie"},{index:"6",label:"Sáb"},{index:"0",label:"Dom"}],ei=["1","2","3","4","5"],en=["6","0"],ec=er.reduce((e,a)=>(e[a.index]={open:"07:00",close:"23:00",closed:!1},e),{});function eo(){let{user:e,loading:t}=(0,m.useAuth)(),[s,r]=(0,l.useState)(!0),[i,n]=(0,l.useState)(!1),[c,d]=(0,l.useState)(null),[u,S]=(0,l.useState)("America/Argentina/Buenos_Aires"),[k,L]=(0,l.useState)(60),[E,I]=(0,l.useState)(ec),[T,O]=(0,l.useState)(er[0].index),[R,B]=(0,l.useState)(new Set(ei)),[A,_]=(0,l.useState)("09:00"),[D,M]=(0,l.useState)("23:00"),[P,U]=(0,l.useState)(!1);(0,l.useEffect)(()=>{let a=async()=>{if(e)try{let a=(0,x.doc)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.settings,w.CENTER_SETTINGS_DOCS.booking),l=await (0,x.getDoc)(a);if(l.exists()){let e=l.data();S(e.timezone||u),L(e.slotDurationMinutes||60),I({...ec,...e.openingHours||{}})}else await (0,x.setDoc)(a,{timezone:u,slotDurationMinutes:k,openingHours:ec,updatedAt:(0,x.serverTimestamp)()},{merge:!0})}catch(e){console.error("Failed to load booking settings:",e),d({type:"error",text:"No se pudo cargar la configuración de horarios."})}finally{r(!1)}};!t&&e&&a()},[t,e]);let z=(e,a,l)=>{I(t=>({...t,[e]:{...t[e],[a]:l}}))},F=(e,a)=>{I(l=>{let t={...l};for(let l of e)t[l]={...t[l]||ec[l],...a};return t})},H=(0,l.useMemo)(()=>{let e=E[T];if(!e||e.closed)return[];let a=(0,o.timeToMinutes)(e.open),l=(0,o.timeToMinutes)(e.close),t=[];for(let e=a;e+k<=l;e+=k)t.push((0,o.minutesToTime)(e));return t},[E,T,k]),$=async()=>{if(e){n(!0),d(null);try{let a=(0,x.doc)(h.db,w.FIRESTORE_COLLECTIONS.centers,e.uid,w.CENTER_SUBCOLLECTIONS.settings,w.CENTER_SETTINGS_DOCS.booking);await (0,x.setDoc)(a,{timezone:u,slotDurationMinutes:k,openingHours:E,updatedAt:(0,x.serverTimestamp)()},{merge:!0}),d({type:"success",text:"Horario guardado."})}catch(e){console.error("Failed to save schedule:",e),d({type:"error",text:"No se pudo guardar el horario."})}finally{n(!1)}}};return s?(0,a.jsxs)("div",{className:"flex items-center justify-center py-10 text-black",children:[(0,a.jsx)(f.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Cargando horario…"]}):(0,a.jsxs)("div",{className:"space-y-6",children:[c&&(0,a.jsx)(v.Alert,{className:`mb-2 ${"success"===c.type?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,a.jsxs)(v.AlertDescription,{className:"success"===c.type?"text-green-800":"text-red-800",children:["success"===c.type?(0,a.jsx)(C.CheckCircle,{className:"w-4 h-4 inline mr-2"}):(0,a.jsx)(N.AlertCircle,{className:"w-4 h-4 inline mr-2"}),c.text]})}),(0,a.jsxs)(b.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,a.jsx)(b.CardHeader,{children:(0,a.jsx)(b.CardTitle,{className:"text-lg text-slate-900",children:"Horarios de apertura y duración de turnos"})}),(0,a.jsxs)(b.CardContent,{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Zona horaria"}),(0,a.jsx)(g.Input,{value:u,onChange:e=>S(e.target.value),placeholder:"America/Argentina/Buenos_Aires"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Duración del turno"}),(0,a.jsxs)(j.Select,{value:k.toString(),onValueChange:e=>L(Number(e)),children:[(0,a.jsx)(j.SelectTrigger,{children:(0,a.jsx)(j.SelectValue,{})}),(0,a.jsx)(j.SelectContent,{children:es.map(e=>(0,a.jsxs)(j.SelectItem,{value:e.toString(),children:[e," minutos"]},e))})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:er.map(e=>(0,a.jsx)(p.Button,{variant:T===e.index?"default":"outline",size:"sm",onClick:()=>O(e.index),className:T===e.index?"bg-blue-600 hover:bg-blue-700":"",children:e.label},e.index))}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,a.jsx)("div",{className:"text-xs text-black",children:"Copiar este día a:"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>F(Object.keys(E),{...E[T]}),children:"Todos los días"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>F(ei,{...E[T]}),children:"Días de semana"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>F(en,{...E[T]}),children:"Fines de semana"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_auto] gap-3 items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Apertura"}),(0,a.jsx)(g.Input,{type:"time",value:E[T]?.open,onChange:e=>z(T,"open",e.target.value),disabled:E[T]?.closed})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Cierre"}),(0,a.jsx)(g.Input,{type:"time",value:E[T]?.close,onChange:e=>z(T,"close",e.target.value),disabled:E[T]?.closed})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-black pb-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:!!E[T]?.closed,onChange:e=>z(T,"closed",e.target.checked)}),"Cerrado"]})]})]}),(0,a.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"Aplicación masiva"}),(0,a.jsx)("div",{className:"text-xs text-black",children:"Configura horarios una vez y aplícalos a varios días."})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>B(new Set(Object.keys(ec))),children:"Seleccionar todo"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>B(new Set(ei)),children:"Días de semana"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>B(new Set(en)),children:"Fines de semana"})]})]}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:er.map(e=>{let l=R.has(e.index);return(0,a.jsx)(p.Button,{type:"button",variant:l?"default":"outline",size:"sm",onClick:()=>{var a;return a=e.index,void B(e=>{let l=new Set(e);return l.has(a)?l.delete(a):l.add(a),l})},className:l?"bg-blue-600 hover:bg-blue-700":"",children:e.label},e.index)})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_auto] gap-3 items-end",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Apertura"}),(0,a.jsx)(g.Input,{type:"time",value:A,onChange:e=>_(e.target.value),disabled:P})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(y.Label,{children:"Cierre"}),(0,a.jsx)(g.Input,{type:"time",value:D,onChange:e=>M(e.target.value),disabled:P})]}),(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-black pb-2",children:[(0,a.jsx)("input",{type:"checkbox",checked:P,onChange:e=>U(e.target.checked)}),"Cerrado"]})]}),(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{_("09:00"),M("23:00"),U(!1)},children:"Preajuste 09:00–23:00"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{_("08:00"),M("22:00"),U(!1)},children:"Preajuste 08:00–22:00"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{_("00:00"),M("23:59"),U(!1)},children:"Preajuste 24h"}),(0,a.jsx)(p.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>U(!0),children:"Preajuste cerrado"})]}),(0,a.jsx)(p.Button,{type:"button",onClick:()=>F(Array.from(R),{open:A,close:D,closed:P}),disabled:0===R.size,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Aplicar a seleccionados"})]})]})}),(0,a.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-slate-900 mb-2",children:"Vista previa de turnos"}),E[T]?.closed?(0,a.jsx)("div",{className:"text-sm text-black",children:"Cerrado"}):H.length?(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[H.slice(0,16).map(e=>(0,a.jsx)("span",{className:"px-2.5 py-1 rounded-full bg-white border border-slate-200 text-xs text-slate-900",children:e},e)),H.length>16?(0,a.jsxs)("span",{className:"text-xs text-black self-center",children:["+",H.length-16," más"]}):null]}):(0,a.jsx)("div",{className:"text-sm text-black",children:"No hay turnos para este día."})]}),(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(p.Button,{onClick:$,disabled:i,className:"bg-blue-600 hover:bg-blue-700 text-white",children:i?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.Loader2,{className:"w-4 h-4 animate-spin mr-2"}),"Guardando…"]}):"Guardar horario"})})]})]})]})}let ed=[{key:"profile",label:"Perfil del club"},{key:"courts",label:"Canchas"},{key:"schedule",label:"Horarios"}];function eu(){let e=(0,t.useSearchParams)(),s=(0,t.useRouter)(),r=e.get("tab")||"profile",i=(0,l.useMemo)(()=>ed.some(e=>e.key===r)?r:"profile",[r]);return(0,a.jsxs)(u,{title:"Configuración del club",description:"Administra el perfil público de tu club, canchas y horarios. Esto se muestra en las páginas de /clubs.",children:[(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:ed.map(e=>(0,a.jsx)(p.Button,{variant:i===e.key?"default":"outline",size:"sm",onClick:()=>{var a;let l;return a=e.key,void((l=new URL(window.location.href)).searchParams.set("tab",a),s.push(l.pathname+l.search))},className:i===e.key?"bg-blue-600 hover:bg-blue-700":"",children:e.label},e.key))}),"profile"===i?(0,a.jsx)(Y,{}):null,"courts"===i?(0,a.jsx)(et,{}):null,"schedule"===i?(0,a.jsx)(eo,{}):null]})}e.s(["default",()=>eu],59824)}]);