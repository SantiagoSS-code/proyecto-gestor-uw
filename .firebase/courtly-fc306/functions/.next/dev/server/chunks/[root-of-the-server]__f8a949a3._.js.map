{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 40, "column": 0}, "map": {"version":3,"sources":["file:///Users/santisanchez/Documents/GitHub/proyecto-gestor-uw/app/api/send-verification-code/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\"\n\nexport async function POST(request: Request) {\n  try {\n    const { email, code, name } = await request.json()\n\n    if (!email || !code) {\n      return NextResponse.json({ error: \"Email y código son requeridos\" }, { status: 400 })\n    }\n\n    // Use Resend to send the verification email\n    // If you don't have Resend, we'll use a fallback approach\n    const RESEND_API_KEY = process.env.RESEND_API_KEY\n\n    if (RESEND_API_KEY) {\n      const response = await fetch(\"https://api.resend.com/emails\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${RESEND_API_KEY}`,\n        },\n        body: JSON.stringify({\n          from: process.env.RESEND_FROM_EMAIL || \"Courtly <onboarding@resend.dev>\",\n          to: [email],\n          subject: \"Tu código de verificación - Courtly\",\n          html: `\n            <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px;\">\n              <div style=\"text-align: center; margin-bottom: 30px;\">\n                <h1 style=\"color: #2563eb; margin: 0;\">courtly</h1>\n              </div>\n              <h2 style=\"color: #333; text-align: center;\">Código de Verificación</h2>\n              <p style=\"color: #666;\">Hola${name ? ` ${name}` : ''},</p>\n              <p style=\"color: #666;\">Tu código de verificación es:</p>\n              <div style=\"background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%); padding: 25px; text-align: center; margin: 25px 0; border-radius: 12px;\">\n                <span style=\"font-size: 36px; font-weight: bold; letter-spacing: 10px; color: #fff;\">${code}</span>\n              </div>\n              <p style=\"color: #666;\">Este código expira en <strong>10 minutos</strong>.</p>\n              <p style=\"color: #999; font-size: 14px;\">Si no solicitaste este código, puedes ignorar este email.</p>\n              <hr style=\"border: none; border-top: 1px solid #eee; margin: 30px 0;\" />\n              <p style=\"color: #999; font-size: 12px; text-align: center;\">\n                © 2026 Courtly. Todos los derechos reservados.\n              </p>\n            </div>\n          `,\n        }),\n      })\n\n      if (!response.ok) {\n        const errorData = await response.json()\n        console.log(\"[Courtly] Resend error:\", errorData)\n        // Fallback: return success but log the code for testing\n        console.log(`[Courtly] Verification code for ${email}: ${code}`)\n        return NextResponse.json({\n          success: true,\n          message: \"Código enviado (modo desarrollo)\",\n          debug_code: process.env.NODE_ENV === \"development\" ? code : undefined,\n        })\n      }\n\n      return NextResponse.json({ success: true, message: \"Código enviado\" })\n    } else {\n      // No Resend API key - development mode\n      // Log the code so it can be used for testing\n      console.log(`[Courtly] Verification code for ${email}: ${code}`)\n\n      return NextResponse.json({\n        success: true,\n        message: \"Código enviado (modo desarrollo - revisa la consola del servidor)\",\n        // In development, return the code so we can test\n        debug_code: process.env.NODE_ENV === \"development\" ? code : undefined,\n      })\n    }\n  } catch (error) {\n    console.log(\"[Courtly] Send verification code error:\", error)\n    return NextResponse.json({ error: \"Error al enviar el código de verificación\" }, { status: 500 })\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;AAEO,eAAe,KAAK,OAAgB;IACzC,IAAI;QACF,MAAM,EAAE,KAAK,EAAE,IAAI,EAAE,IAAI,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEhD,IAAI,CAAC,SAAS,CAAC,MAAM;YACnB,OAAO,wTAAY,CAAC,IAAI,CAAC;gBAAE,OAAO;YAAgC,GAAG;gBAAE,QAAQ;YAAI;QACrF;QAEA,4CAA4C;QAC5C,0DAA0D;QAC1D,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc;QAEjD,IAAI,gBAAgB;YAClB,MAAM,WAAW,MAAM,MAAM,iCAAiC;gBAC5D,QAAQ;gBACR,SAAS;oBACP,gBAAgB;oBAChB,eAAe,CAAC,OAAO,EAAE,gBAAgB;gBAC3C;gBACA,MAAM,KAAK,SAAS,CAAC;oBACnB,MAAM,QAAQ,GAAG,CAAC,iBAAiB,IAAI;oBACvC,IAAI;wBAAC;qBAAM;oBACX,SAAS;oBACT,MAAM,CAAC;;;;;;0CAMyB,EAAE,OAAO,CAAC,CAAC,EAAE,MAAM,GAAG,GAAG;;;qGAGkC,EAAE,KAAK;;;;;;;;;UASlG,CAAC;gBACH;YACF;YAEA,IAAI,CAAC,SAAS,EAAE,EAAE;gBAChB,MAAM,YAAY,MAAM,SAAS,IAAI;gBACrC,QAAQ,GAAG,CAAC,2BAA2B;gBACvC,wDAAwD;gBACxD,QAAQ,GAAG,CAAC,CAAC,gCAAgC,EAAE,MAAM,EAAE,EAAE,MAAM;gBAC/D,OAAO,wTAAY,CAAC,IAAI,CAAC;oBACvB,SAAS;oBACT,SAAS;oBACT,YAAY,uCAAyC,OAAO;gBAC9D;YACF;YAEA,OAAO,wTAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;gBAAM,SAAS;YAAiB;QACtE,OAAO;YACL,uCAAuC;YACvC,6CAA6C;YAC7C,QAAQ,GAAG,CAAC,CAAC,gCAAgC,EAAE,MAAM,EAAE,EAAE,MAAM;YAE/D,OAAO,wTAAY,CAAC,IAAI,CAAC;gBACvB,SAAS;gBACT,SAAS;gBACT,iDAAiD;gBACjD,YAAY,uCAAyC,OAAO;YAC9D;QACF;IACF,EAAE,OAAO,OAAO;QACd,QAAQ,GAAG,CAAC,2CAA2C;QACvD,OAAO,wTAAY,CAAC,IAAI,CAAC;YAAE,OAAO;QAA4C,GAAG;YAAE,QAAQ;QAAI;IACjG;AACF"}}]
}