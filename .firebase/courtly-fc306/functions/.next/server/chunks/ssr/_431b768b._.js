module.exports=[41372,(a,b,c)=>{"use strict";b.exports=a.r(60888).vendored["react-ssr"].ReactServerDOMTurbopackClient},3339,34051,a=>{"use strict";var b=a.i(80940);function c(a,b){if("function"==typeof a)return a(b);null!=a&&(a.current=b)}function d(...a){return b=>{let d=!1,e=a.map(a=>{let e=c(a,b);return d||"function"!=typeof e||(d=!0),e});if(d)return()=>{for(let b=0;b<e.length;b++){let d=e[b];"function"==typeof d?d():c(a[b],null)}}}}function e(...a){return b.useCallback(d(...a),a)}a.s(["composeRefs",()=>d,"useComposedRefs",()=>e],34051);var f=a.i(82746),g=b.forwardRef((a,c)=>{let{children:d,...e}=a,g=b.Children.toArray(d),i=g.find(j);if(i){let a=i.props.children,d=g.map(c=>c!==i?c:b.Children.count(a)>1?b.Children.only(null):b.isValidElement(a)?a.props.children:null);return(0,f.jsx)(h,{...e,ref:c,children:b.isValidElement(a)?b.cloneElement(a,void 0,d):null})}return(0,f.jsx)(h,{...e,ref:c,children:d})});g.displayName="Slot";var h=b.forwardRef((a,c)=>{let{children:e,...f}=a;if(b.isValidElement(e)){var g;let a,h,i=(g=e,(h=(a=Object.getOwnPropertyDescriptor(g.props,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?g.ref:(h=(a=Object.getOwnPropertyDescriptor(g,"ref")?.get)&&"isReactWarning"in a&&a.isReactWarning)?g.props.ref:g.props.ref||g.ref);return b.cloneElement(e,{...function(a,b){let c={...b};for(let d in b){let e=a[d],f=b[d];/^on[A-Z]/.test(d)?e&&f?c[d]=(...a)=>{f(...a),e(...a)}:e&&(c[d]=e):"style"===d?c[d]={...e,...f}:"className"===d&&(c[d]=[e,f].filter(Boolean).join(" "))}return{...a,...c}}(f,e.props),ref:c?d(c,i):i})}return b.Children.count(e)>1?b.Children.only(null):null});h.displayName="SlotClone";var i=({children:a})=>(0,f.jsx)(f.Fragment,{children:a});function j(a){return b.isValidElement(a)&&a.type===i}a.s(["Slot",()=>g],3339)},40695,42261,a=>{"use strict";var b=a.i(82746),c=a.i(3339),d=a.i(39337);let e=a=>"boolean"==typeof a?`${a}`:0===a?"0":a,f=d.clsx,g=(a,b)=>c=>{var d;if((null==b?void 0:b.variants)==null)return f(a,null==c?void 0:c.class,null==c?void 0:c.className);let{variants:g,defaultVariants:h}=b,i=Object.keys(g).map(a=>{let b=null==c?void 0:c[a],d=null==h?void 0:h[a];if(null===b)return null;let f=e(b)||e(d);return g[a][f]}),j=c&&Object.entries(c).reduce((a,b)=>{let[c,d]=b;return void 0===d||(a[c]=d),a},{});return f(a,i,null==b||null==(d=b.compoundVariants)?void 0:d.reduce((a,b)=>{let{class:c,className:d,...e}=b;return Object.entries(e).every(a=>{let[b,c]=a;return Array.isArray(c)?c.includes({...h,...j}[b]):({...h,...j})[b]===c})?[...a,c,d]:a},[]),null==c?void 0:c.class,null==c?void 0:c.className)};a.s(["cva",0,g],42261);var h=a.i(97895);let i=g("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-black shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function j({className:a,variant:d,size:e,asChild:f=!1,...g}){let j=f?c.Slot:"button";return(0,b.jsx)(j,{"data-slot":"button",className:(0,h.cn)(i({variant:d,size:e,className:a})),...g})}a.s(["Button",()=>j],40695)},61237,a=>{"use strict";var b=a.i(80940);let c=(...a)=>a.filter((a,b,c)=>!!a&&""!==a.trim()&&c.indexOf(a)===b).join(" ").trim();var d={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let e=(0,b.forwardRef)(({color:a="currentColor",size:e=24,strokeWidth:f=2,absoluteStrokeWidth:g,className:h="",children:i,iconNode:j,...k},l)=>(0,b.createElement)("svg",{ref:l,...d,width:e,height:e,stroke:a,strokeWidth:g?24*Number(f)/Number(e):f,className:c("lucide",h),...k},[...j.map(([a,c])=>(0,b.createElement)(a,c)),...Array.isArray(i)?i:[i]])),f=(a,d)=>{let f=(0,b.forwardRef)(({className:f,...g},h)=>(0,b.createElement)(e,{ref:h,iconNode:d,className:c(`lucide-${a.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,f),...g}));return f.displayName=`${a}`,f};a.s(["default",()=>f],61237)},28980,a=>{"use strict";let b=(0,a.i(61237).default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);a.s(["Sparkles",()=>b],28980)},18704,a=>{"use strict";a.i(53585);var b=a.i(83058);a.i(62886);var c=a.i(33638);a.i(56108);var d=a.i(42070);let e="true"===process.env.NEXT_PUBLIC_USE_FIREBASE_EMULATOR,f="courtly-fc306",g="backoffice",h=(0,b.getApps)().find(a=>a.name===g)??(0,b.initializeApp)({apiKey:"AIzaSyADZo0vFlXYkd3XHcJUhRL0NFaS2sZ6liQ",authDomain:"courtly-backoffice.firebaseapp.com",projectId:e&&f?f:"courtly-backoffice",storageBucket:"courtly-backoffice.firebasestorage.app",messagingSenderId:"934882408358",appId:"1:934882408358:web:79687b1ef84c5e525c4167"},g),i=(0,c.getAuth)(h),j=(0,d.getFirestore)(h);if(e)try{let a="127.0.0.1";(0,c.connectAuthEmulator)(i,`http://${a}:9099`),(0,d.connectFirestoreEmulator)(j,a,8080)}catch{console.log("Backoffice emulators already connected")}a.s(["authBackoffice",0,i])},77440,a=>{"use strict";var b=a.i(18704);class c extends Error{status;constructor(a,b){super(b),this.status=a}}async function d(a,d){let e=b.authBackoffice.currentUser;if(!e)throw Error("Not signed in");let f=await e.getIdToken(),g=await fetch(a,{...d,headers:{...d?.headers||{},Authorization:`Bearer ${f}`,"Content-Type":"application/json"}}),h=g.headers.get("content-type")||"";if(!g.ok){let a=`Request failed (${g.status})`,b="";if(h.includes("application/json")){let b=await g.json().catch(()=>null);a=b?.error||b?.message||a}else b=await g.text().catch(()=>"");if(b){let a=b.length>500?`${b.slice(0,500)}…`:b;console.error("[Backoffice] API error response",g.status,a)}else console.error("[Backoffice] API error response",g.status,a);throw new c(g.status,a)}if(!h.includes("application/json")){let a=await g.text().catch(()=>""),b=a.length>500?`${a.slice(0,500)}…`:a;throw console.error("[Backoffice] Non-JSON API response",g.status,b),new c(g.status,"Expected JSON response from API")}return await g.json()}a.s(["BackofficeRequestError",()=>c,"backofficeFetch",()=>d])},40076,a=>{"use strict";let b=(0,a.i(61237).default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);a.s(["Building2",()=>b],40076)},6665,a=>{"use strict";let b=(0,a.i(61237).default)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);a.s(["Users",()=>b],6665)},33038,a=>{"use strict";let b=(0,a.i(61237).default)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);a.s(["CreditCard",()=>b],33038)},74246,a=>{"use strict";let b=(0,a.i(61237).default)("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);a.s(["LayoutDashboard",()=>b],74246)},78234,a=>{"use strict";let b=(0,a.i(61237).default)("Grid2x2",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M12 3v18",key:"108xh3"}]]);a.s(["Grid2X2",()=>b],78234)},98278,a=>{"use strict";var b=a.i(82746),c=a.i(80940);a.i(62886);var d=a.i(33638),e=a.i(18704);let f=(0,c.createContext)({user:null,loading:!0});function g({children:a}){let[g,h]=(0,c.useState)(null),[i,j]=(0,c.useState)(!0);return(0,c.useEffect)(()=>{let a=(0,d.onAuthStateChanged)(e.authBackoffice,a=>{h(a),j(!1)});return()=>a()},[]),(0,b.jsx)(f.Provider,{value:{user:g,loading:i},children:a})}a.s(["BackofficeAuthProvider",()=>g,"useBackofficeAuth",0,()=>{let a=(0,c.useContext)(f);if(!a)throw Error("useBackofficeAuth must be used within a BackofficeAuthProvider");return a}])},47611,a=>{"use strict";var b=a.i(82746),c=a.i(80940),d=a.i(16119),e=a.i(62158);a.i(62886);var f=a.i(33638),g=a.i(98278),h=a.i(77440),i=a.i(18704),j=a.i(97895),k=a.i(40695),l=a.i(28980),m=a.i(74246),n=a.i(6665),o=a.i(40076),p=a.i(78234),q=a.i(61237);let r=(0,q.default)("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);var s=a.i(33038);let t=(0,q.default)("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]),u=[{href:"/backoffice",label:"Overview",icon:m.LayoutDashboard},{href:"/backoffice/players",label:"Players",icon:n.Users},{href:"/backoffice/centers",label:"Centers/Clubs",icon:o.Building2},{href:"/backoffice/courts",label:"Courts",icon:p.Grid2X2},{href:"/backoffice/bookings",label:"Bookings",icon:r},{href:"/backoffice/payments",label:"Payments",icon:s.CreditCard},{href:"/backoffice/support",label:"Support/Reports",icon:t,disabled:!0}];function v({children:a}){let m=(0,d.usePathname)(),n=(0,d.useRouter)(),{user:o,loading:p}=(0,g.useBackofficeAuth)(),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(!0),[v,w]=(0,c.useState)(null);(0,c.useEffect)(()=>{let a=async()=>{if(o)try{await (0,h.backofficeFetch)("/api/backoffice/me"),r(!0),w(null)}catch(a){r(!1),w(a?.message||"Forbidden")}finally{t(!1)}};!p&&o&&a(),p||o||t(!1)},[p,o]);let x=(0,c.useMemo)(()=>p||s?(0,b.jsx)("div",{className:"min-h-[50vh] flex items-center justify-center text-slate-600",children:"Loading…"}):o?q?null:(0,b.jsxs)("div",{className:"min-h-[50vh] flex flex-col items-center justify-center gap-2",children:[(0,b.jsx)("div",{className:"text-slate-900 font-semibold",children:"403 — Forbidden"}),(0,b.jsx)("div",{className:"text-slate-600 text-sm",children:"This area is restricted to platform admins."}),null,(0,b.jsx)(k.Button,{variant:"outline",onClick:async()=>{await (0,f.signOut)(i.authBackoffice),await fetch("/api/auth/session",{method:"DELETE",credentials:"include"}).catch(()=>null),n.replace("/backoffice/login")},className:"mt-2",children:"Sign out"})]}):(0,b.jsxs)("div",{className:"min-h-[50vh] flex flex-col items-center justify-center gap-3",children:[(0,b.jsx)("div",{className:"text-slate-900 font-semibold",children:"Sign in required"}),(0,b.jsx)("div",{className:"text-slate-600 text-sm",children:"You must sign in to access the back office."}),(0,b.jsx)(e.default,{href:"/backoffice/login",children:(0,b.jsx)(k.Button,{className:"bg-blue-600 hover:bg-blue-700",children:"Go to login"})})]}),[q,p,v,s,n,o]);return x?(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50",children:(0,b.jsx)("div",{className:"max-w-6xl mx-auto px-4 py-10",children:x})}):(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[260px_1fr] gap-6",children:[(0,b.jsxs)("aside",{className:"bg-white border border-slate-200/70 shadow-sm rounded-2xl p-4 h-fit",children:[(0,b.jsxs)(e.default,{href:"/",className:"flex items-center gap-2 mb-6",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-600 flex items-center justify-center",children:(0,b.jsx)(l.Sparkles,{className:"w-4 h-4 text-white"})}),(0,b.jsxs)("div",{className:"leading-tight",children:[(0,b.jsx)("div",{className:"font-semibold text-lg tracking-tight text-slate-900",children:"courtly"}),(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Back Office"})]})]}),(0,b.jsx)("nav",{className:"space-y-1",children:u.map(a=>{let c=m===a.href,d=a.icon,f=!!a.disabled;return(0,b.jsxs)(e.default,{href:f?"#":a.href,"aria-disabled":f,className:(0,j.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors",f&&"opacity-50 pointer-events-none",c?"bg-blue-600 text-white":"text-slate-700 hover:bg-slate-100"),children:[(0,b.jsx)(d,{className:"w-4 h-4"}),a.label]},a.href)})}),(0,b.jsx)("div",{className:"mt-6 border-t border-slate-200 pt-4",children:(0,b.jsx)(k.Button,{variant:"outline",className:"w-full",onClick:async()=>{await (0,f.signOut)(i.authBackoffice),await fetch("/api/auth/session",{method:"DELETE",credentials:"include"}).catch(()=>null),n.replace("/backoffice/login")},children:"Sign out"})})]}),(0,b.jsx)("section",{className:"bg-white border border-slate-200/70 shadow-sm rounded-2xl p-6",children:a})]})})})}function w({children:a}){let{user:e,loading:f}=(0,g.useBackofficeAuth)(),h=(0,d.usePathname)(),i=(0,d.useRouter)(),j="/backoffice/login"===h;return((0,c.useEffect)(()=>{f||e||j||i.replace("/backoffice/login")},[f,e,j,i]),j)?(0,b.jsx)(b.Fragment,{children:a}):f?(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-slate-600",children:"Loading backoffice…"})}):e?(0,b.jsx)(v,{children:a}):(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50 flex items-center justify-center",children:(0,b.jsx)("div",{className:"text-slate-600",children:"Redirecting…"})})}function x({children:a}){return(0,b.jsx)(g.BackofficeAuthProvider,{children:(0,b.jsx)(w,{children:a})})}a.s(["default",()=>x],47611)}];

//# sourceMappingURL=_431b768b._.js.map