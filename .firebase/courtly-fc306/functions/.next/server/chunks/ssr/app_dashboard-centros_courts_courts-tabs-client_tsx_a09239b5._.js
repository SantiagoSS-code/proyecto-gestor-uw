module.exports=[33840,a=>{"use strict";var b=a.i(82746),c=a.i(80940),d=a.i(16119),e=a.i(62158),f=a.i(28980),g=a.i(74246),h=a.i(78234),i=a.i(11292),j=a.i(97895);let k=[{href:"/dashboard-centros",label:"Panel",icon:g.LayoutDashboard},{href:"/dashboard-centros/courts",label:"Canchas",icon:h.Grid2X2},{href:"/dashboard-centros/settings",label:"Configuración",icon:i.Settings}];function l({title:a,description:c,children:g}){let h=(0,d.usePathname)();return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 via-white to-slate-50",children:(0,b.jsx)("div",{className:"max-w-7xl mx-auto px-4 py-8",children:(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[240px_1fr] gap-6",children:[(0,b.jsxs)("aside",{className:"bg-white border border-slate-200/70 shadow-sm rounded-2xl p-4 h-fit",children:[(0,b.jsxs)(e.default,{href:"/",className:"flex items-center gap-2 mb-6",children:[(0,b.jsx)("div",{className:"w-8 h-8 rounded-lg bg-blue-600 flex items-center justify-center",children:(0,b.jsx)(f.Sparkles,{className:"w-4 h-4 text-white"})}),(0,b.jsx)("span",{className:"font-semibold text-lg tracking-tight text-slate-900",children:"courtly"})]}),(0,b.jsx)("nav",{className:"space-y-1",children:k.map(a=>{let c=h===a.href,d=a.icon;return(0,b.jsxs)(e.default,{href:a.href,className:(0,j.cn)("flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium transition-colors",c?"bg-blue-600 text-white":"text-slate-700 hover:bg-slate-100"),children:[(0,b.jsx)(d,{className:"w-4 h-4"}),a.label]},a.href)})})]}),(0,b.jsxs)("section",{className:"bg-white border border-slate-200/70 shadow-sm rounded-2xl p-6",children:[(0,b.jsxs)("div",{className:"mb-6",children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:a}),c?(0,b.jsx)("p",{className:"text-black mt-2",children:c}):null]}),g]})]})})})}var m=a.i(40695),n=a.i(21937),o=a.i(99996);a.i(56108);var p=a.i(42070),q=a.i(3130),r=a.i(5522),s=a.i(17171),t=a.i(87682),u=a.i(65602),v=a.i(84435),w=a.i(71917),x=a.i(12582),y=a.i(61237);let z=(0,y.default)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);var A=a.i(31823);let B=(0,y.default)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var C=a.i(96826);let D=(0,y.default)("Pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),E=["padel","tennis","futbol","pickleball","squash"],F=[{value:1,label:"Lun"},{value:2,label:"Mar"},{value:3,label:"Mié"},{value:4,label:"Jue"},{value:5,label:"Vie"},{value:6,label:"Sáb"},{value:0,label:"Dom"}],G={name:"",sport:"padel",coachName:"",durationMinutes:60,price:0,currency:"ARS",capacity:8,recurringSchedule:[],enabled:!0};function H(){let{user:a,loading:d}=(0,n.useAuth)(),[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),[y,z]=(0,c.useState)({...G}),[H,I]=(0,c.useState)(null),J=(0,c.useMemo)(()=>y.name.trim().length>0,[y.name]);(0,c.useEffect)(()=>{let b=async()=>{if(a)try{let b=(0,p.collection)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.classes),c=(await (0,p.getDocs)(b)).docs.map(a=>({id:a.id,...a.data()}));f(c)}catch(a){console.error("Error loading classes:",a),I({type:"error",text:"No se pudieron cargar las clases."})}finally{h(!1)}};!d&&a&&b()},[d,a]);let K=()=>{l(null),z({...G})},L=async()=>{if(a&&J){j(!0),I(null);try{let b={name:y.name.trim(),sport:y.sport,coachName:y.coachName?.trim()||"",durationMinutes:Number(y.durationMinutes)||60,price:Number(y.price)||0,currency:y.currency||"ARS",capacity:Number(y.capacity)||0,recurringSchedule:y.recurringSchedule||[],enabled:!!y.enabled,updatedAt:(0,p.serverTimestamp)()};if(k){let c=(0,p.doc)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.classes,k);await (0,p.updateDoc)(c,b),f(a=>a.map(a=>a.id===k?{...a,...b}:a)),I({type:"success",text:"Clase actualizada."})}else{let c=(0,p.collection)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.classes),d=await (0,p.addDoc)(c,{...b,createdAt:(0,p.serverTimestamp)()});f(a=>[...a,{id:d.id,...b}]),I({type:"success",text:"Clase creada."})}K()}catch(a){console.error("Error saving class:",a),I({type:"error",text:"No se pudo guardar la clase."})}finally{j(!1)}}},M=async b=>{if(a&&window.confirm("¿Eliminar esta clase?"))try{await (0,p.deleteDoc)((0,p.doc)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.classes,b)),f(a=>a.filter(a=>a.id!==b))}catch(a){console.error("Error deleting class:",a),I({type:"error",text:"No se pudo eliminar la clase."})}},N=(a,b)=>{z(c=>{let d=[...c.recurringSchedule||[]];return d[a]={...d[a],...b},{...c,recurringSchedule:d}})};return(0,b.jsxs)("div",{className:"space-y-6",children:[H&&(0,b.jsx)(u.Alert,{className:`mb-2 ${"success"===H.type?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,b.jsxs)(u.AlertDescription,{className:"success"===H.type?"text-green-800":"text-red-800",children:["success"===H.type?(0,b.jsx)(w.CheckCircle,{className:"w-4 h-4 inline mr-2"}):(0,b.jsx)(x.AlertCircle,{className:"w-4 h-4 inline mr-2"}),H.text]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1.2fr_0.8fr] gap-6",children:[(0,b.jsxs)(q.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,b.jsxs)(q.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsx)(q.CardTitle,{className:"text-lg text-slate-900",children:"Clases"}),(0,b.jsxs)(m.Button,{variant:"outline",size:"sm",onClick:K,className:"text-black",children:[(0,b.jsx)(B,{className:"w-4 h-4 mr-2"}),"Nueva clase"]})]}),(0,b.jsx)(q.CardContent,{className:"space-y-3",children:g?(0,b.jsxs)("div",{className:"flex items-center justify-center py-10 text-black",children:[(0,b.jsx)(v.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Cargando clases…"]}):0===e.length?(0,b.jsx)("div",{className:"text-center text-black py-10",children:"Aún no hay clases."}):e.map(a=>(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 rounded-xl border border-slate-200 p-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-slate-900",children:a.name}),(0,b.jsxs)("p",{className:"text-sm text-black",children:[(a.sport||"padel").toUpperCase()," · ",a.durationMinutes," min · ",a.currency||"ARS"," ",a.price]}),(0,b.jsx)("p",{className:"text-xs text-slate-600 mt-1",children:!1!==a.enabled?"Activa":"Pausada"})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(m.Button,{variant:"outline",size:"sm",onClick:()=>{l(a.id),z({name:a.name,sport:a.sport,coachName:a.coachName||"",durationMinutes:a.durationMinutes||60,price:a.price||0,currency:a.currency||"ARS",capacity:a.capacity||0,recurringSchedule:a.recurringSchedule||[],enabled:!1!==a.enabled})},children:(0,b.jsx)(D,{className:"w-4 h-4"})}),(0,b.jsx)(m.Button,{variant:"destructive",size:"sm",onClick:()=>M(a.id),children:(0,b.jsx)(C.Trash2,{className:"w-4 h-4"})})]})]},a.id))})]}),(0,b.jsxs)(q.Card,{className:"border border-slate-200/70 shadow-sm h-fit",children:[(0,b.jsx)(q.CardHeader,{children:(0,b.jsx)(q.CardTitle,{className:"text-lg text-slate-900",children:k?"Editar clase":"Crear clase"})}),(0,b.jsxs)(q.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Nombre"}),(0,b.jsx)(r.Input,{value:y.name,onChange:a=>z({...y,name:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Deporte"}),(0,b.jsxs)(t.Select,{value:y.sport,onValueChange:a=>z({...y,sport:a}),children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"Deporte"})}),(0,b.jsx)(t.SelectContent,{children:E.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:a},a))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Coach"}),(0,b.jsx)(r.Input,{value:y.coachName||"",onChange:a=>z({...y,coachName:a.target.value})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Duración (min)"}),(0,b.jsx)(r.Input,{type:"number",min:"30",value:y.durationMinutes,onChange:a=>z({...y,durationMinutes:Number(a.target.value)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Capacidad"}),(0,b.jsx)(r.Input,{type:"number",min:"1",value:y.capacity,onChange:a=>z({...y,capacity:Number(a.target.value)})})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Precio"}),(0,b.jsx)(r.Input,{type:"number",min:"0",value:y.price,onChange:a=>z({...y,price:Number(a.target.value)})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Moneda"}),(0,b.jsx)(r.Input,{value:y.currency||"ARS",onChange:a=>z({...y,currency:a.target.value})})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Activa"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!y.enabled,onChange:a=>z({...y,enabled:a.target.checked}),className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm text-black",children:"Disponible para reservas"})]})]}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-white p-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"Horarios recurrentes"}),(0,b.jsxs)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{z(a=>({...a,recurringSchedule:[...a.recurringSchedule||[],{dayOfWeek:1,startTime:"18:00",endTime:"19:00"}]}))},children:[(0,b.jsx)(B,{className:"w-4 h-4 mr-1"}),"Añadir"]})]}),(0,b.jsx)("div",{className:"mt-3 space-y-2",children:0===(y.recurringSchedule||[]).length?(0,b.jsx)("div",{className:"text-xs text-slate-600",children:"Sin horarios aún."}):y.recurringSchedule.map((a,c)=>(0,b.jsxs)("div",{className:"grid grid-cols-[1fr_1fr_1fr_auto] gap-2 items-center",children:[(0,b.jsxs)(t.Select,{value:String(a.dayOfWeek),onValueChange:a=>N(c,{dayOfWeek:Number(a)}),children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{})}),(0,b.jsx)(t.SelectContent,{children:F.map(a=>(0,b.jsx)(t.SelectItem,{value:String(a.value),children:a.label},a.value))})]}),(0,b.jsx)(r.Input,{type:"time",value:a.startTime,onChange:a=>N(c,{startTime:a.target.value})}),(0,b.jsx)(r.Input,{type:"time",value:a.endTime,onChange:a=>N(c,{endTime:a.target.value})}),(0,b.jsx)(m.Button,{type:"button",variant:"ghost",size:"icon",onClick:()=>{z(a=>({...a,recurringSchedule:(a.recurringSchedule||[]).filter((a,b)=>b!==c)}))},children:(0,b.jsx)(C.Trash2,{className:"w-4 h-4"})})]},c))})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[k?(0,b.jsx)(m.Button,{variant:"outline",onClick:K,children:"Cancelar"}):null,(0,b.jsx)(m.Button,{onClick:L,disabled:i||!J,className:"bg-blue-600 hover:bg-blue-700 text-white",children:i?(0,b.jsx)(v.Loader2,{className:"w-4 h-4 animate-spin"}):"Guardar"})]})]})]})]})]})}var I=a.i(9599);function J(a){return a.name}let K=(a,b,c=J)=>c(a)<c(b)?-1:+(c(a)>c(b));var L=a.i(15268),M=a.i(39940);let N=["name","countryCode","stateCode","latitude","longitude"],O=[],P=a=>{let b=a.trim().toLowerCase();return a=>!b||a.name.toLowerCase().includes(b)},Q=(a,b)=>a.label.localeCompare(b.label),R=a=>{let b=new Set;return a.filter(a=>{let c=a.label.toLowerCase();return!b.has(c)&&(b.add(c),!0)})},S=(a,b)=>{let c=a.address||{};return[c.suburb,c.neighbourhood,c.hamlet,c.village,c.town,c.city,c.municipality,c.county,...b].find(Boolean)||a.display_name},T=async(a,b)=>{let c=`/api/geo/search?q=${encodeURIComponent(a)}&limit=${b}`,d=await fetch(c);return d.ok?await d.json():[]},U=async(a,b,c)=>{let d=new URLSearchParams;d.set("postalcode",a),d.set("limit",String(c)),b&&d.set("countrycodes",b);let e=await fetch(`/api/geo/search?${d.toString()}`);return e.ok?await e.json():[]};async function V({level:a,parentId:b=null,search:c="",maxResults:d=200,context:e}){if("country"===a)return I.default.filter(P(c)).map(a=>({id:`country-${a.isoCode}`,label:a.name,level:"country",parentId:null})).sort(Q).slice(0,d);if("province"===a&&b){let a=b.replace("country-","");return(function(a=""){return a?L.default.filter(b=>b.countryCode===a).sort(K):[]})(a).filter(P(c)).map(c=>({id:`province-${a}-${c.isoCode}`,label:c.name,level:"province",parentId:b})).sort(Q).slice(0,d)}if(("city"===a||"locality"===a||"postalCode"===a)&&b){var f,g;let h=b.split("-"),i=h[1],j=h[2],k=e?.countryLabel||"",l=e?.provinceLabel||"",m=e?.cityLabel||"",n=e?.countryId?.replace("country-","")||null;if("postalCode"===a){if(!c.trim())return[];let a=await U(c,n,Math.min(d,25));return R(a.map(a=>a.address?.postcode||a.display_name).filter(Boolean).map((c,d)=>{let e=a[d];return{id:`postal-${i}-${j}-${String(c).replace(/\s+/g,"")}`,label:String(c),level:"postalCode",parentId:b,lat:e?.lat?Number(e.lat):null,lng:e?.lon?Number(e.lon):null}})).slice(0,d)}if("locality"===a){if(!c.trim())return[];let a=[c,m,l,k].filter(Boolean).join(", ");return R((await T(a,Math.min(d,25))).map(a=>({id:`locality-${a.place_id}`,label:S(a,[a.display_name]),level:"locality",parentId:b,lat:a.lat?Number(a.lat):null,lng:a.lon?Number(a.lon):null}))).slice(0,d)}if(c.trim()){let a=[c,l,k].filter(Boolean).join(", ");return R((await T(a,Math.min(d,25))).map(a=>({id:`city-${a.place_id}`,label:S(a,[a.display_name]),level:"city",parentId:b,lat:a.lat?Number(a.lat):null,lng:a.lon?Number(a.lon):null}))).slice(0,d)}return(f=i,(g=j)&&f?(function(a=N){var b;if(O.length)return O;let c=M.default;return b=null!=a?a:N,O=c.map(a=>Object.fromEntries(b.map((b,c)=>[b,a[c]])))})().filter(a=>a.countryCode===f&&a.stateCode===g).sort(K):[]).filter(P(c)).map(a=>({id:`city-${i}-${j}-${a.name}`,label:a.name,level:"city",parentId:b})).sort(Q).slice(0,d)}return[]}let W=[{key:"bar",label:"Bar"},{key:"bathrooms",label:"Baños"},{key:"showers",label:"Duchas"},{key:"gym",label:"Gimnasio"},{key:"parking",label:"Estacionamiento"},{key:"lockers",label:"Vestuarios"},{key:"wifi",label:"Wi‑Fi"},{key:"shop",label:"Tienda"},{key:"cafeteria",label:"Cafetería"}],X=[{key:"padel",label:"Padel"},{key:"tennis",label:"Tennis"},{key:"futbol",label:"Fútbol"},{key:"pickleball",label:"Pickleball"},{key:"squash",label:"Squash"}],Y={country:null,province:null,city:null,locality:null,postalCode:null};function Z({label:a,placeholder:c,value:d,options:e,loading:f,disabled:g,searchValue:h,onSearchChange:i,onSelect:j,emptyMessage:k}){let l=e.filter(a=>a.label.toLowerCase().includes(h.trim().toLowerCase()));return(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:a}),(0,b.jsxs)(t.Select,{value:d?.id||"",onValueChange:a=>{let b=e.find(b=>b.id===a);b&&j(b)},disabled:g,children:[(0,b.jsx)(t.SelectTrigger,{className:"w-full",children:(0,b.jsx)(t.SelectValue,{placeholder:c})}),(0,b.jsxs)(t.SelectContent,{children:[(0,b.jsx)("div",{className:"p-2",children:(0,b.jsx)(r.Input,{value:h,onChange:a=>i(a.target.value),placeholder:"Buscar…",className:"h-8",disabled:g})}),(0,b.jsx)(t.SelectSeparator,{}),f?(0,b.jsx)(t.SelectItem,{value:"__loading",disabled:!0,children:"Cargando…"}):l.length?l.map(a=>(0,b.jsx)(t.SelectItem,{value:a.id,children:a.label},a.id)):(0,b.jsx)(t.SelectItem,{value:"__empty",disabled:!0,children:k})]})]})]})}async function $(a,b){let c=(0,j.slugify)(a);if(!c)return"";let d=async a=>{let c=(0,p.query)((0,p.collection)(o.db,A.FIRESTORE_COLLECTIONS.centers),(0,p.where)("slug","==",a));return(await (0,p.getDocs)(c)).docs.some(a=>a.id!==b)};if(!await d(c))return c;for(let a=2;a<=50;a++){let b=`${c}-${a}`;if(!await d(b))return b}return`${c}-${Date.now()}`}function _(){let{user:a,loading:d}=(0,n.useAuth)(),[e,f]=(0,c.useState)(!0),[g,h]=(0,c.useState)(!1),[i,k]=(0,c.useState)(null),[l,t]=(0,c.useState)({name:"",phone:"",address:"",street:"",streetNumber:"",province:"",postalCode:"",city:"",country:"",placeId:"",location:null,description:"",amenities:[],sports:["padel"],coverImageUrl:null,galleryImageUrls:[],slug:"",published:!1,classesEnabled:!1,featuredRank:null,topSearchedRank:null}),[y,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!1),[G,I]=(0,c.useState)(Y),[J,K]=(0,c.useState)({country:"",province:"",city:"",locality:"",postalCode:""}),[L,M]=(0,c.useState)([]),[N,O]=(0,c.useState)([]),[P,Q]=(0,c.useState)([]),[R,S]=(0,c.useState)([]),[T,U]=(0,c.useState)([]),[_,aa]=(0,c.useState)({country:!1,province:!1,city:!1,locality:!1,postalCode:!1});(0,c.useEffect)(()=>{let b=async()=>{if(a)try{let b=(0,p.doc)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid),c=await (0,p.getDoc)(b);if(c.exists()){let a=c.data();t(b=>({...b,...a,name:a.name||b.name,street:a.street||b.street,streetNumber:a.streetNumber||b.streetNumber,province:a.province||b.province,postalCode:a.postalCode||b.postalCode,amenities:a.amenities||[],sports:a.sports||[],galleryImageUrls:a.galleryImageUrls||[],coverImageUrl:a.coverImageUrl??null,published:!!a.published,slug:a.slug||"",placeId:a.placeId||"",location:a.location||null,classesEnabled:!!a.classesEnabled})),a.location?.lat&&B(String(a.location.lat)),a.location?.lng&&D(String(a.location.lng));let b=a.location||null,d=b?.country?.id?b.country:null,e=b?.province?.id?b.province:null,f=b?.city?.id?b.city:null,g=b?.locality?.id?b.locality:null,h=b?.postalCode?.id?b.postalCode:null;I({country:d,province:e,city:f,locality:g,postalCode:h})}else await (0,p.setDoc)(b,{name:"",published:!1,createdAt:(0,p.serverTimestamp)()},{merge:!0})}catch(a){console.error("Failed to load club profile:",a),k({type:"error",text:"No se pudo cargar el perfil del club."})}finally{f(!1)}};!d&&a&&b()},[d,a]);let ab=(0,c.useMemo)(()=>l.name.trim().length>0,[l.name]),ac=(0,c.useMemo)(()=>[[l.street?.trim(),l.streetNumber?.trim()].filter(Boolean).join(" "),[G.locality?.label,G.city?.label,G.province?.label,G.postalCode?.label,G.country?.label].filter(Boolean).join(", ")].filter(Boolean).join(", "),[l.street,l.streetNumber,G]);(0,c.useEffect)(()=>{let a=!0;return(async()=>{aa(a=>({...a,country:!0}));try{let b=await V({level:"country",search:J.country});a&&M(b)}catch(a){console.error("Failed to load countries",a)}finally{a&&aa(a=>({...a,country:!1}))}})(),()=>{a=!1}},[J.country]),(0,c.useEffect)(()=>{if(!G.country?.id)return void O([]);let a=!0;return(async()=>{aa(a=>({...a,province:!0}));try{let b=await V({level:"province",parentId:G.country?.id,search:J.province});a&&O(b)}catch(a){console.error("Failed to load provinces",a)}finally{a&&aa(a=>({...a,province:!1}))}})(),()=>{a=!1}},[J.province,G.country?.id]),(0,c.useEffect)(()=>{if(!G.province?.id)return void Q([]);let a=!0;return(async()=>{aa(a=>({...a,city:!0}));try{let b=await V({level:"city",parentId:G.province?.id,search:J.city,context:{countryLabel:G.country?.label,provinceLabel:G.province?.label,countryId:G.country?.id}});a&&Q(b)}catch(a){console.error("Failed to load cities",a)}finally{a&&aa(a=>({...a,city:!1}))}})(),()=>{a=!1}},[J.city,G.province?.id]),(0,c.useEffect)(()=>{if(!G.city?.id)return void S([]);let a=!0;return(async()=>{aa(a=>({...a,locality:!0}));try{let b=await V({level:"locality",parentId:G.city?.id,search:J.locality,context:{countryLabel:G.country?.label,provinceLabel:G.province?.label,cityLabel:G.city?.label,countryId:G.country?.id}});a&&S(b)}catch(a){console.error("Failed to load localities",a)}finally{a&&aa(a=>({...a,locality:!1}))}})(),()=>{a=!1}},[J.locality,G.city?.id]),(0,c.useEffect)(()=>{if(!G.locality?.id)return void U([]);let a=!0;return(async()=>{aa(a=>({...a,postalCode:!0}));try{let b=await V({level:"postalCode",parentId:G.locality?.id,search:J.postalCode,context:{countryLabel:G.country?.label,provinceLabel:G.province?.label,cityLabel:G.city?.label,countryId:G.country?.id}});a&&U(b)}catch(a){console.error("Failed to load postal codes",a)}finally{a&&aa(a=>({...a,postalCode:!1}))}})(),()=>{a=!1}},[J.postalCode,G.locality?.id]);let ad=async()=>{if(a){k(null);try{let b=await $(l.name,a.uid);t(a=>({...a,slug:b}))}catch(a){console.error("Slug generation failed:",a),k({type:"error",text:"No se pudo generar un slug único."})}}},ae=async()=>{if(a){F(!0);try{let b=(0,p.collection)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.courts),c=await (0,p.getDocs)(b),d=Array.from(new Set(c.docs.map(a=>a.data()?.sport).filter(Boolean)));t(a=>({...a,sports:d}))}catch(a){console.error("Failed to sync sports:",a),k({type:"error",text:"No se pudieron sincronizar los deportes."})}finally{F(!1)}}},af=async()=>{if(a&&ab){h(!0),k(null);try{let b=a.uid,c=l.coverImageUrl||null,d=[...l.galleryImageUrls||[]];if(!l.slug){let a=await $(l.name,b);t(b=>({...b,slug:a}))}let e=""===y.trim()?NaN:Number(y),f=""===C.trim()?NaN:Number(C),g={country:G.country,province:G.province,city:G.city,locality:G.locality,postalCode:G.postalCode,fullAddress:ac,lat:Number.isFinite(e)?e:null,lng:Number.isFinite(f)?f:null},h={name:l.name.trim(),phone:l.phone?.trim()||"",address:ac||l.address?.trim()||"",street:l.street?.trim()||"",streetNumber:l.streetNumber?.trim()||"",province:G.province?.label||"",postalCode:G.postalCode?.label||"",city:G.city?.label||"",country:G.country?.label||"",placeId:l.placeId?.trim()||"",location:g,description:l.description?.trim()||"",amenities:l.amenities||[],sports:l.sports||[],coverImageUrl:c,galleryImageUrls:d,slug:l.slug?(0,j.slugify)(l.slug):(0,j.slugify)(l.name),published:!!l.published,classesEnabled:!!l.classesEnabled,featuredRank:l.featuredRank??null,topSearchedRank:l.topSearchedRank??null,updatedAt:(0,p.serverTimestamp)()},i=(0,p.doc)(o.db,A.FIRESTORE_COLLECTIONS.centers,b);await (0,p.updateDoc)(i,h),t(a=>({...a,coverImageUrl:c,galleryImageUrls:d,slug:h.slug})),k({type:"success",text:"Perfil del club guardado."})}catch(a){console.error("Save club profile failed:",a),k({type:"error",text:"No se pudo guardar el perfil del club."})}finally{h(!1)}}};return e?(0,b.jsxs)("div",{className:"flex items-center justify-center py-10 text-black",children:[(0,b.jsx)(v.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Cargando perfil del club…"]}):(0,b.jsxs)("div",{className:"space-y-6",children:[i&&(0,b.jsx)(u.Alert,{className:`mb-2 ${"success"===i.type?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,b.jsxs)(u.AlertDescription,{className:"success"===i.type?"text-green-800":"text-red-800",children:["success"===i.type?(0,b.jsx)(w.CheckCircle,{className:"w-4 h-4 inline mr-2"}):(0,b.jsx)(x.AlertCircle,{className:"w-4 h-4 inline mr-2"}),i.text]})}),(0,b.jsxs)(q.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,b.jsx)(q.CardHeader,{children:(0,b.jsx)(q.CardTitle,{className:"text-lg text-slate-900",children:"Perfil público del club"})}),(0,b.jsxs)(q.CardContent,{className:"space-y-5",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Nombre del club"}),(0,b.jsx)(r.Input,{value:l.name,onChange:a=>t({...l,name:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Teléfono"}),(0,b.jsx)(r.Input,{value:l.phone||"",onChange:a=>t({...l,phone:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Calle"}),(0,b.jsx)(r.Input,{value:l.street||"",onChange:a=>t({...l,street:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Número"}),(0,b.jsx)(r.Input,{value:l.streetNumber||"",onChange:a=>t({...l,streetNumber:a.target.value})})]}),(0,b.jsx)(Z,{label:"País",placeholder:"Seleccionar país",value:G.country,options:L,loading:_.country,searchValue:J.country,onSearchChange:a=>K(b=>({...b,country:a})),onSelect:a=>{I({country:a,province:null,city:null,locality:null,postalCode:null}),K(a=>({...a,province:"",city:"",locality:"",postalCode:""})),O([]),Q([]),S([]),U([])},emptyMessage:"No hay países disponibles."}),(0,b.jsx)(Z,{label:"Provincia / Estado",placeholder:G.country?"Seleccionar provincia":"Seleccioná un país",value:G.province,options:N,loading:_.province,disabled:!G.country,searchValue:J.province,onSearchChange:a=>K(b=>({...b,province:a})),onSelect:a=>{I({country:G.country,province:a,city:null,locality:null,postalCode:null}),K(a=>({...a,city:"",locality:"",postalCode:""})),Q([]),S([]),U([])},emptyMessage:G.country?"Sin provincias para este país.":"Seleccioná un país primero."}),(0,b.jsx)(Z,{label:"Ciudad",placeholder:G.province?"Seleccionar ciudad":"Seleccioná una provincia",value:G.city,options:P,loading:_.city,disabled:!G.province,searchValue:J.city,onSearchChange:a=>K(b=>({...b,city:a})),onSelect:a=>{I({country:G.country,province:G.province,city:a,locality:null,postalCode:null}),"number"==typeof a.lat&&"number"==typeof a.lng&&(B(String(a.lat)),D(String(a.lng))),K(a=>({...a,locality:"",postalCode:""})),S([]),U([])},emptyMessage:G.province?J.city?"Sin resultados para esa búsqueda.":"Escribí para buscar una ciudad.":"Seleccioná una provincia primero."}),(0,b.jsx)(Z,{label:"Localidad",placeholder:G.city?"Seleccionar localidad":"Seleccioná una ciudad",value:G.locality,options:R,loading:_.locality,disabled:!G.city,searchValue:J.locality,onSearchChange:a=>K(b=>({...b,locality:a})),onSelect:a=>{I({country:G.country,province:G.province,city:G.city,locality:a,postalCode:null}),"number"==typeof a.lat&&"number"==typeof a.lng&&(B(String(a.lat)),D(String(a.lng))),K(a=>({...a,postalCode:""})),U([])},emptyMessage:G.city?J.locality?"Sin resultados para esa búsqueda.":"Escribí para buscar una localidad.":"Seleccioná una ciudad primero."}),(0,b.jsx)(Z,{label:"Código postal",placeholder:G.locality?"Seleccionar código postal":"Seleccioná una localidad",value:G.postalCode,options:T,loading:_.postalCode,disabled:!G.locality,searchValue:J.postalCode,onSearchChange:a=>K(b=>({...b,postalCode:a})),onSelect:a=>{I({country:G.country,province:G.province,city:G.city,locality:G.locality,postalCode:a}),"number"==typeof a.lat&&"number"==typeof a.lng&&(B(String(a.lat)),D(String(a.lng)))},emptyMessage:G.locality?J.postalCode?"Sin resultados para esa búsqueda.":"Escribí para buscar un código postal.":"Seleccioná una localidad primero."}),(0,b.jsxs)("div",{className:"md:col-span-2",children:[(0,b.jsx)(s.Label,{children:"Dirección completa (autogenerada)"}),(0,b.jsx)(r.Input,{value:ac,readOnly:!0,className:"bg-slate-50"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Descripción"}),(0,b.jsx)("textarea",{value:l.description||"",onChange:a=>t({...l,description:a.target.value}),className:"w-full min-h-[120px] rounded-md border border-slate-200 px-3 py-2 text-sm"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Google Maps Place ID (opcional)"}),(0,b.jsx)(r.Input,{value:l.placeId||"",onChange:a=>t({...l,placeId:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Coordenadas (lat, lng)"}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,b.jsx)(r.Input,{value:y,onChange:a=>B(a.target.value),placeholder:"-34.6037"}),(0,b.jsx)(r.Input,{value:C,onChange:a=>D(a.target.value),placeholder:"-58.3816"})]})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-slate-900 mb-2",children:"Servicios"}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:W.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-black",children:[(0,b.jsx)("input",{type:"checkbox",checked:(l.amenities||[]).includes(a.key),onChange:()=>{var b;return b=a.key,void t(a=>{let c=new Set(a.amenities||[]);return c.has(b)?c.delete(b):c.add(b),{...a,amenities:Array.from(c)}})}}),a.label]},a.key))})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-2",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"Deportes disponibles"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:ae,disabled:E,children:E?(0,b.jsx)(v.Loader2,{className:"w-4 h-4 animate-spin"}):"Sincronizar desde canchas"})]}),(0,b.jsx)("div",{className:"grid grid-cols-2 gap-2",children:X.map(a=>(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-black",children:[(0,b.jsx)("input",{type:"checkbox",checked:(l.sports||[]).includes(a.key),onChange:()=>{var b;return b=a.key,void t(a=>{let c=new Set(a.sports||[]);return c.has(b)?c.delete(b):c.add(b),{...a,sports:Array.from(c)}})}}),a.label]},a.key))})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Imagen de portada"}),(0,b.jsx)(r.Input,{type:"text",placeholder:"https://ejemplo.com/imagen.jpg",value:l.coverImageUrl||"",onChange:a=>t({...l,coverImageUrl:a.target.value||null})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Pega la URL de una imagen (Google Drive, redes sociales, etc.)"}),l.coverImageUrl?(0,b.jsx)("img",{src:l.coverImageUrl,alt:"",className:"mt-3 h-40 w-full object-cover rounded-xl border border-slate-200"}):null]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Imágenes de la galería (URLs separadas por coma)"}),(0,b.jsx)(r.Input,{type:"text",placeholder:"https://url1.jpg, https://url2.jpg",value:(l.galleryImageUrls||[]).join(", "),onChange:a=>{let b=a.target.value.split(",").map(a=>a.trim()).filter(Boolean);t({...l,galleryImageUrls:b})}}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-1",children:"Pega URLs separadas por coma"}),l.galleryImageUrls?.length?(0,b.jsx)("div",{className:"mt-3 grid grid-cols-3 gap-2",children:l.galleryImageUrls.slice(0,6).map(a=>(0,b.jsx)("img",{src:a,alt:"",className:"h-20 w-full object-cover rounded-lg border border-slate-200"},a))}):null]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Slug"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(r.Input,{value:l.slug||"",onChange:a=>t({...l,slug:a.target.value})}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",onClick:ad,className:"text-black",children:(0,b.jsx)(z,{className:"w-4 h-4"})})]}),(0,b.jsxs)("div",{className:"text-xs text-black mt-1",children:["URL pública: /clubs/",l.slug||"…"]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Publicar"}),(0,b.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-black",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!l.published,onChange:a=>t({...l,published:a.target.checked})}),"Visible en /clubs"]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Clases habilitadas"}),(0,b.jsxs)("div",{className:"mt-2 flex items-center gap-2 text-sm text-black",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!l.classesEnabled,onChange:a=>t({...l,classesEnabled:a.target.checked})}),"Mostrar clases en la página pública"]})]}),(0,b.jsx)("div",{className:"flex items-center justify-end gap-3",children:(0,b.jsx)(m.Button,{onClick:af,disabled:g||!ab,className:"bg-blue-600 hover:bg-blue-700 text-white",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Loader2,{className:"w-4 h-4 animate-spin mr-2"}),"Guardando…"]}):"Guardar perfil"})})]})]}),l.classesEnabled?(0,b.jsxs)(q.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,b.jsx)(q.CardHeader,{children:(0,b.jsx)(q.CardTitle,{className:"text-lg text-slate-900",children:"Clases y escuelas"})}),(0,b.jsx)(q.CardContent,{children:(0,b.jsx)(H,{})})]}):null]})}let aa=["Sintética","Césped","Arcilla","Dura","Otra"],ab=["padel","tennis","futbol","pickleball","squash"],ac={name:"",sport:"padel",indoor:!1,surfaceType:"Synthetic",pricePerHour:"",currency:"ARS",published:!0};function ad(){let{user:a,loading:d}=(0,n.useAuth)(),[e,f]=(0,c.useState)([]),[g,h]=(0,c.useState)(!0),[i,j]=(0,c.useState)(!1),[k,l]=(0,c.useState)(null),[y,z]=(0,c.useState)({...ac}),[E,F]=(0,c.useState)(null),G=(0,c.useMemo)(()=>y.name.trim().length>0,[y.name]);(0,c.useEffect)(()=>{let b=async()=>{if(a)try{let b=(0,p.collection)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.courts),c=(await (0,p.getDocs)(b)).docs.map(a=>({id:a.id,...a.data()}));f(c)}catch(a){console.error("Error loading courts:",a),F({type:"error",text:"No se pudieron cargar las canchas. Intenta de nuevo."})}finally{h(!1)}};!d&&a&&b()},[d,a]);let H=()=>{l(null),z({...ac})},I=async()=>{if(a&&G){j(!0),F(null);try{let b={name:y.name.trim(),sport:y.sport,indoor:y.indoor,surfaceType:y.surfaceType,pricePerHour:y.pricePerHour?Number(y.pricePerHour):null,currency:"ARS",published:!!y.published,updatedAt:(0,p.serverTimestamp)()};if(k){let c=(0,p.doc)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.courts,k);await (0,p.updateDoc)(c,b),f(a=>a.map(a=>a.id===k?{...a,...b}:a)),F({type:"success",text:"Cancha actualizada correctamente."})}else{let c=(0,p.collection)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.courts),d=await (0,p.addDoc)(c,{...b,createdAt:(0,p.serverTimestamp)()});f(a=>[...a,{id:d.id,...b}]),F({type:"success",text:"Cancha creada correctamente."})}H()}catch(a){console.error("Error saving court:",a),F({type:"error",text:"No se pudo guardar la cancha. Intenta de nuevo."})}finally{j(!1)}}},J=async b=>{if(a&&window.confirm("¿Eliminar esta cancha? Esta acción no se puede deshacer."))try{await (0,p.deleteDoc)((0,p.doc)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.courts,b)),f(a=>a.filter(a=>a.id!==b))}catch(a){console.error("Error deleting court:",a),F({type:"error",text:"No se pudo eliminar la cancha. Intenta de nuevo."})}};return(0,b.jsxs)("div",{className:"space-y-6",children:[E&&(0,b.jsx)(u.Alert,{className:`mb-2 ${"success"===E.type?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,b.jsxs)(u.AlertDescription,{className:"success"===E.type?"text-green-800":"text-red-800",children:["success"===E.type?(0,b.jsx)(w.CheckCircle,{className:"w-4 h-4 inline mr-2"}):(0,b.jsx)(x.AlertCircle,{className:"w-4 h-4 inline mr-2"}),E.text]})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-[1.2fr_0.8fr] gap-6",children:[(0,b.jsxs)(q.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,b.jsxs)(q.CardHeader,{className:"flex flex-row items-center justify-between",children:[(0,b.jsx)(q.CardTitle,{className:"text-lg text-slate-900",children:"Tus canchas"}),(0,b.jsxs)(m.Button,{variant:"outline",size:"sm",onClick:H,className:"text-black",children:[(0,b.jsx)(B,{className:"w-4 h-4 mr-2"}),"Nueva cancha"]})]}),(0,b.jsx)(q.CardContent,{className:"space-y-3",children:g?(0,b.jsxs)("div",{className:"flex items-center justify-center py-10 text-black",children:[(0,b.jsx)(v.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Cargando canchas…"]}):0===e.length?(0,b.jsx)("div",{className:"text-center text-black py-10",children:"Aún no hay canchas. Crea tu primera cancha."}):e.map(a=>(0,b.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4 rounded-xl border border-slate-200 p-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h3",{className:"font-semibold text-slate-900",children:a.name}),(0,b.jsxs)("p",{className:"text-sm text-black",children:[(a.sport||"padel").toUpperCase()," · ",a.indoor?"Interior":"Exterior"," · ",a.surfaceType||"—","number"==typeof a.pricePerHour?` \xb7 ${a.currency||"USD"} ${a.pricePerHour}/h`:""]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:`px-2.5 py-1 rounded-full text-xs font-semibold ${!1!==a.published?"bg-blue-50 text-blue-700":"bg-slate-100 text-slate-700"}`,children:!1!==a.published?"Publicada":"Borrador"}),(0,b.jsx)(m.Button,{variant:"outline",size:"sm",onClick:()=>{l(a.id),z({name:a.name,sport:a.sport||"padel",indoor:!!a.indoor,surfaceType:a.surfaceType||"Synthetic",pricePerHour:"number"==typeof a.pricePerHour?a.pricePerHour.toString():"",currency:"ARS",published:!1!==a.published})},children:(0,b.jsx)(D,{className:"w-4 h-4"})}),(0,b.jsx)(m.Button,{variant:"destructive",size:"sm",onClick:()=>J(a.id),children:(0,b.jsx)(C.Trash2,{className:"w-4 h-4"})})]})]},a.id))})]}),(0,b.jsxs)(q.Card,{className:"border border-slate-200/70 shadow-sm h-fit",children:[(0,b.jsx)(q.CardHeader,{children:(0,b.jsx)(q.CardTitle,{className:"text-lg text-slate-900",children:k?"Editar cancha":"Crear cancha"})}),(0,b.jsxs)(q.CardContent,{className:"space-y-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Nombre de la cancha"}),(0,b.jsx)(r.Input,{value:y.name,onChange:a=>z({...y,name:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Deporte"}),(0,b.jsxs)(t.Select,{value:y.sport,onValueChange:a=>z({...y,sport:a}),children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"Deporte"})}),(0,b.jsx)(t.SelectContent,{children:ab.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:a},a))})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Superficie"}),(0,b.jsxs)(t.Select,{value:y.surfaceType,onValueChange:a=>z({...y,surfaceType:a}),children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{placeholder:"Tipo de superficie"})}),(0,b.jsx)(t.SelectContent,{children:aa.map(a=>(0,b.jsx)(t.SelectItem,{value:a,children:a},a))})]})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Interior"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:y.indoor,onChange:a=>z({...y,indoor:a.target.checked}),className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm text-black",children:"Esta cancha es interior"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Precio por hora"}),(0,b.jsx)(r.Input,{type:"number",min:"0",value:y.pricePerHour,onChange:a=>z({...y,pricePerHour:a.target.value})})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Moneda"}),(0,b.jsx)(r.Input,{value:"ARS",disabled:!0})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Publicada"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:y.published,onChange:a=>z({...y,published:a.target.checked}),className:"h-4 w-4"}),(0,b.jsx)("span",{className:"text-sm text-black",children:"Mostrar esta cancha en páginas públicas"})]})]}),(0,b.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[k?(0,b.jsx)(m.Button,{variant:"outline",onClick:H,children:"Cancelar"}):null,(0,b.jsx)(m.Button,{onClick:I,disabled:i||!G,className:"bg-blue-600 hover:bg-blue-700 text-white",children:i?(0,b.jsx)(v.Loader2,{className:"w-4 h-4 animate-spin"}):"Guardar"})]})]})]})]})]})}let ae=[30,60,90,120],af=[{index:"1",label:"Lun"},{index:"2",label:"Mar"},{index:"3",label:"Mié"},{index:"4",label:"Jue"},{index:"5",label:"Vie"},{index:"6",label:"Sáb"},{index:"0",label:"Dom"}],ag=["1","2","3","4","5"],ah=["6","0"],ai=af.reduce((a,b)=>(a[b.index]={open:"07:00",close:"23:00",closed:!1},a),{});function aj(){let{user:a,loading:d}=(0,n.useAuth)(),[e,f]=(0,c.useState)(!0),[g,h]=(0,c.useState)(!1),[i,k]=(0,c.useState)(null),[l,y]=(0,c.useState)("America/Argentina/Buenos_Aires"),[z,B]=(0,c.useState)(60),[C,D]=(0,c.useState)(ai),[E,F]=(0,c.useState)(af[0].index),[G,H]=(0,c.useState)(new Set(ag)),[I,J]=(0,c.useState)("09:00"),[K,L]=(0,c.useState)("23:00"),[M,N]=(0,c.useState)(!1);(0,c.useEffect)(()=>{let b=async()=>{if(a)try{let b=(0,p.doc)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.settings,A.CENTER_SETTINGS_DOCS.booking),c=await (0,p.getDoc)(b);if(c.exists()){let a=c.data();y(a.timezone||l),B(a.slotDurationMinutes||60),D({...ai,...a.openingHours||{}})}else await (0,p.setDoc)(b,{timezone:l,slotDurationMinutes:z,openingHours:ai,updatedAt:(0,p.serverTimestamp)()},{merge:!0})}catch(a){console.error("Failed to load booking settings:",a),k({type:"error",text:"No se pudo cargar la configuración de horarios."})}finally{f(!1)}};!d&&a&&b()},[d,a]);let O=(a,b,c)=>{D(d=>({...d,[a]:{...d[a],[b]:c}}))},P=(a,b)=>{D(c=>{let d={...c};for(let c of a)d[c]={...d[c]||ai[c],...b};return d})},Q=(0,c.useMemo)(()=>{let a=C[E];if(!a||a.closed)return[];let b=(0,j.timeToMinutes)(a.open),c=(0,j.timeToMinutes)(a.close),d=[];for(let a=b;a+z<=c;a+=z)d.push((0,j.minutesToTime)(a));return d},[C,E,z]),R=async()=>{if(a){h(!0),k(null);try{let b=(0,p.doc)(o.db,A.FIRESTORE_COLLECTIONS.centers,a.uid,A.CENTER_SUBCOLLECTIONS.settings,A.CENTER_SETTINGS_DOCS.booking);await (0,p.setDoc)(b,{timezone:l,slotDurationMinutes:z,openingHours:C,updatedAt:(0,p.serverTimestamp)()},{merge:!0}),k({type:"success",text:"Horario guardado."})}catch(a){console.error("Failed to save schedule:",a),k({type:"error",text:"No se pudo guardar el horario."})}finally{h(!1)}}};return e?(0,b.jsxs)("div",{className:"flex items-center justify-center py-10 text-black",children:[(0,b.jsx)(v.Loader2,{className:"w-5 h-5 animate-spin mr-2"}),"Cargando horario…"]}):(0,b.jsxs)("div",{className:"space-y-6",children:[i&&(0,b.jsx)(u.Alert,{className:`mb-2 ${"success"===i.type?"border-green-200 bg-green-50":"border-red-200 bg-red-50"}`,children:(0,b.jsxs)(u.AlertDescription,{className:"success"===i.type?"text-green-800":"text-red-800",children:["success"===i.type?(0,b.jsx)(w.CheckCircle,{className:"w-4 h-4 inline mr-2"}):(0,b.jsx)(x.AlertCircle,{className:"w-4 h-4 inline mr-2"}),i.text]})}),(0,b.jsxs)(q.Card,{className:"border border-slate-200/70 shadow-sm",children:[(0,b.jsx)(q.CardHeader,{children:(0,b.jsx)(q.CardTitle,{className:"text-lg text-slate-900",children:"Horarios de apertura y duración de turnos"})}),(0,b.jsxs)(q.CardContent,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Zona horaria"}),(0,b.jsx)(r.Input,{value:l,onChange:a=>y(a.target.value),placeholder:"America/Argentina/Buenos_Aires"})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Duración del turno"}),(0,b.jsxs)(t.Select,{value:z.toString(),onValueChange:a=>B(Number(a)),children:[(0,b.jsx)(t.SelectTrigger,{children:(0,b.jsx)(t.SelectValue,{})}),(0,b.jsx)(t.SelectContent,{children:ae.map(a=>(0,b.jsxs)(t.SelectItem,{value:a.toString(),children:[a," minutos"]},a))})]})]})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:af.map(a=>(0,b.jsx)(m.Button,{variant:E===a.index?"default":"outline",size:"sm",onClick:()=>F(a.index),className:E===a.index?"bg-blue-600 hover:bg-blue-700":"",children:a.label},a.index))}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[(0,b.jsx)("div",{className:"text-xs text-black",children:"Copiar este día a:"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>P(Object.keys(C),{...C[E]}),children:"Todos los días"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>P(ag,{...C[E]}),children:"Días de semana"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>P(ah,{...C[E]}),children:"Fines de semana"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_auto] gap-3 items-end",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Apertura"}),(0,b.jsx)(r.Input,{type:"time",value:C[E]?.open,onChange:a=>O(E,"open",a.target.value),disabled:C[E]?.closed})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Cierre"}),(0,b.jsx)(r.Input,{type:"time",value:C[E]?.close,onChange:a=>O(E,"close",a.target.value),disabled:C[E]?.closed})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-black pb-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:!!C[E]?.closed,onChange:a=>O(E,"closed",a.target.checked)}),"Cerrado"]})]})]}),(0,b.jsx)("div",{className:"rounded-xl border border-slate-200 bg-white p-4",children:(0,b.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between gap-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{className:"text-sm font-medium text-slate-900",children:"Aplicación masiva"}),(0,b.jsx)("div",{className:"text-xs text-black",children:"Configura horarios una vez y aplícalos a varios días."})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>H(new Set(Object.keys(ai))),children:"Seleccionar todo"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>H(new Set(ag)),children:"Días de semana"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>H(new Set(ah)),children:"Fines de semana"})]})]}),(0,b.jsx)("div",{className:"flex flex-wrap gap-2",children:af.map(a=>{let c=G.has(a.index);return(0,b.jsx)(m.Button,{type:"button",variant:c?"default":"outline",size:"sm",onClick:()=>{var b;return b=a.index,void H(a=>{let c=new Set(a);return c.has(b)?c.delete(b):c.add(b),c})},className:c?"bg-blue-600 hover:bg-blue-700":"",children:a.label},a.index)})}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-[1fr_1fr_auto] gap-3 items-end",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Apertura"}),(0,b.jsx)(r.Input,{type:"time",value:I,onChange:a=>J(a.target.value),disabled:M})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(s.Label,{children:"Cierre"}),(0,b.jsx)(r.Input,{type:"time",value:K,onChange:a=>L(a.target.value),disabled:M})]}),(0,b.jsxs)("label",{className:"flex items-center gap-2 text-sm text-black pb-2",children:[(0,b.jsx)("input",{type:"checkbox",checked:M,onChange:a=>N(a.target.checked)}),"Cerrado"]})]}),(0,b.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{J("09:00"),L("23:00"),N(!1)},children:"Preajuste 09:00–23:00"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{J("08:00"),L("22:00"),N(!1)},children:"Preajuste 08:00–22:00"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>{J("00:00"),L("23:59"),N(!1)},children:"Preajuste 24h"}),(0,b.jsx)(m.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>N(!0),children:"Preajuste cerrado"})]}),(0,b.jsx)(m.Button,{type:"button",onClick:()=>P(Array.from(G),{open:I,close:K,closed:M}),disabled:0===G.size,className:"bg-blue-600 hover:bg-blue-700 text-white",children:"Aplicar a seleccionados"})]})]})}),(0,b.jsxs)("div",{className:"rounded-xl border border-slate-200 bg-slate-50 p-4",children:[(0,b.jsx)("div",{className:"text-sm font-medium text-slate-900 mb-2",children:"Vista previa de turnos"}),C[E]?.closed?(0,b.jsx)("div",{className:"text-sm text-black",children:"Cerrado"}):Q.length?(0,b.jsxs)("div",{className:"flex flex-wrap gap-2",children:[Q.slice(0,16).map(a=>(0,b.jsx)("span",{className:"px-2.5 py-1 rounded-full bg-white border border-slate-200 text-xs text-slate-900",children:a},a)),Q.length>16?(0,b.jsxs)("span",{className:"text-xs text-black self-center",children:["+",Q.length-16," más"]}):null]}):(0,b.jsx)("div",{className:"text-sm text-black",children:"No hay turnos para este día."})]}),(0,b.jsx)("div",{className:"flex justify-end",children:(0,b.jsx)(m.Button,{onClick:R,disabled:g,className:"bg-blue-600 hover:bg-blue-700 text-white",children:g?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(v.Loader2,{className:"w-4 h-4 animate-spin mr-2"}),"Guardando…"]}):"Guardar horario"})})]})]})]})}let ak=[{key:"profile",label:"Perfil del club"},{key:"courts",label:"Canchas"},{key:"schedule",label:"Horarios"}];function al(){let a=(0,d.useSearchParams)(),e=(0,d.useRouter)(),f=a.get("tab")||"profile",g=(0,c.useMemo)(()=>ak.some(a=>a.key===f)?f:"profile",[f]);return(0,b.jsxs)(l,{title:"Configuración del club",description:"Administra el perfil público de tu club, canchas y horarios. Esto se muestra en las páginas de /clubs.",children:[(0,b.jsx)("div",{className:"flex flex-wrap gap-2 mb-6",children:ak.map(a=>(0,b.jsx)(m.Button,{variant:g===a.key?"default":"outline",size:"sm",onClick:()=>{var b;let c;return b=a.key,void((c=new URL(window.location.href)).searchParams.set("tab",b),e.push(c.pathname+c.search))},className:g===a.key?"bg-blue-600 hover:bg-blue-700":"",children:a.label},a.key))}),"profile"===g?(0,b.jsx)(_,{}):null,"courts"===g?(0,b.jsx)(ad,{}):null,"schedule"===g?(0,b.jsx)(aj,{}):null]})}a.s(["default",()=>al],33840)}];

//# sourceMappingURL=app_dashboard-centros_courts_courts-tabs-client_tsx_a09239b5._.js.map